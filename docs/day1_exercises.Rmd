---
title: '<span class="en">Day 1: Exercises</span><span class="de">Tag 1: √úbungen</span>'
subtitle: '<span class="en">Your First Accumulation Curve!</span><span class="de">Deine erste Akkumulationskurve!</span>'
author: '<span class="en">Fill in the blanks!</span><span class="de">F√ºlle die L√ºcken aus!</span>'
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
    self_contained: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE, message = FALSE, warning = FALSE)
```

```{=html}
<style>
/* ========== WORKSHOP THEME ========== */

body {
 font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
 line-height: 1.7;
 background-color: #fafffe;
}

h1 { color: #2E7D32 !important; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
h2 { color: #388E3C !important; margin-top: 2em; }
h3 { color: #43A047 !important; }

pre {
 background-color: #f5f5f5 !important;
 border-left: 4px solid #4CAF50 !important;
 padding: 15px;
 padding-top: 35px;
 border-radius: 8px;
 overflow-x: auto;
 position: relative !important;
}

code {
 background-color: #E8F5E9;
 padding: 2px 6px;
 border-radius: 4px;
 color: #2E7D32;
}

pre code { background-color: transparent; padding: 0; }

.copy-btn {
 position: absolute !important;
 top: 8px !important;
 right: 8px !important;
 padding: 4px 12px;
 font-size: 12px;
 background: #4CAF50;
 color: white;
 border: none;
 border-radius: 4px;
 cursor: pointer;
 opacity: 0;
 transition: opacity 0.2s, background 0.2s;
 z-index: 100;
}

pre:hover .copy-btn { opacity: 1; }
.copy-btn:hover { background: #2E7D32; }
.copy-btn.copied { background: #1976D2; }

blockquote {
 border-left: 4px solid #FF9800;
 background-color: #FFF8E1;
 padding: 15px 20px;
 margin: 1em 0;
 border-radius: 0 8px 8px 0;
}

hr {
 border: none;
 height: 3px;
 background: linear-gradient(to right, #4CAF50, #81C784, #C8E6C9, #81C784, #4CAF50);
 margin: 2em 0;
 border-radius: 2px;
}

.tocify { border: none !important; border-radius: 12px !important; background-color: #f1f8e9 !important; }
.tocify-item.active { background-color: #4CAF50 !important; color: white !important; }

.hint {
 background-color: #E3F2FD;
 border: 1px solid #1976D2;
 border-radius: 8px;
 padding: 10px 15px;
 margin: 1em 0;
 font-size: 0.9em;
}
.hint::before { content: "üí° "; }

/* ========== LANGUAGE TOGGLE ========== */

.lang-toggle {
 position: fixed; top: 10px; right: 20px; z-index: 9999;
 background: linear-gradient(135deg, #2E7D32, #4CAF50);
 padding: 8px 12px; border-radius: 25px;
 box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
}
.lang-toggle button {
 background: transparent; border: none; color: #fff;
 padding: 6px 14px; cursor: pointer; font-weight: bold;
 border-radius: 20px; transition: all 0.3s; font-size: 14px;
}
.lang-toggle button.active { background: white; color: #2E7D32; }
.lang-toggle button:hover:not(.active) { background: rgba(255,255,255,0.2); }

.de { display: none; }
.en { display: inline; }
body.lang-de .de { display: inline; }
body.lang-de .en { display: none; }

div.de, p.de, li.de, h1.de, h2.de, h3.de, section.de { display: none; }
div.en, p.en, li.en, h1.en, h2.en, h3.en, section.en { display: block; }

body.lang-de div.de, body.lang-de p.de, body.lang-de li.de,
body.lang-de h1.de, body.lang-de h2.de, body.lang-de h3.de, body.lang-de section.de { display: block; }

body.lang-de div.en, body.lang-de p.en, body.lang-de li.en,
body.lang-de h1.en, body.lang-de h2.en, body.lang-de h3.en, body.lang-de section.en { display: none; }

body.lang-de #TOC .en { display: none; }
body.lang-de #TOC .de { display: inline; }
#TOC .de { display: none; }
#TOC .en { display: inline; }

@media (max-width: 768px) {
  body { font-size: 14px; }
  .lang-toggle { top: 5px; right: 10px; padding: 5px 8px; }
  .lang-toggle button { padding: 4px 10px; font-size: 12px; }
  pre { font-size: 11px; padding: 10px; }
}
</style>
```

```{=html}
<script>
$(document).ready(function() {
  var toggle = $('<div class="lang-toggle"><button id="btn-en" class="active">EN</button><button id="btn-de">DE</button></div>');
  $('body').append(toggle);

  var savedLang = localStorage.getItem('workshop-lang');
  var browserLang = navigator.language.substring(0, 2);
  var defaultLang = savedLang || (browserLang === 'de' ? 'de' : 'en');

  function setLanguage(lang) {
    $('body').removeClass('lang-en lang-de').addClass('lang-' + lang);
    $('#btn-en').toggleClass('active', lang === 'en');
    $('#btn-de').toggleClass('active', lang === 'de');
    localStorage.setItem('workshop-lang', lang);
  }

  if (defaultLang === 'de') setLanguage('de');

  $('#btn-en').click(function() { setLanguage('en'); });
  $('#btn-de').click(function() { setLanguage('de'); });

  $('pre').each(function() {
    var pre = $(this);
    var btn = $('<button class="copy-btn">Copy</button>');
    btn.click(function() {
      var code = pre.find('code');
      var text = code.length ? code.text() : pre.text();
      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(function() {
          btn.text('Copied!').addClass('copied');
          setTimeout(function() { btn.text('Copy').removeClass('copied'); }, 2000);
        });
      }
    });
    pre.css('position', 'relative').append(btn);
  });
});
</script>
```

---

# <span class="en">Exercise 1: Variables & Vectors</span><span class="de">√úbung 1: Variablen & Vektoren</span>

<div class="en">

In R, we store data in **variables**. A **vector** is a list of values.

</div>

<div class="de">

In R speichern wir Daten in **Variablen**. Ein **Vektor** ist eine Liste von Werten.

</div>

```{r}
# 1a: Store a number in a variable
# 1a: Speichere eine Zahl in einer Variable

my_number <- ___
my_number

# 1b: Store text (needs quotes!)
# 1b: Speichere Text (braucht Anf√ºhrungszeichen!)

my_name <- "___"
my_name

# 1c: Create a vector with c()
# 1c: Erstelle einen Vektor mit c()

species_counts <- c(5, 3, 7, 2, 4)
species_counts

# 1d: Your turn - create a vector of 4 tree heights
# 1d: Du bist dran - erstelle einen Vektor mit 4 Baumh√∂hen

tree_heights <- c(___, ___, ___, ___)
tree_heights

# 1e: Get the length of a vector
# 1e: Hole die L√§nge eines Vektors

length(species_counts)

# 1f: Calculate mean (average)
# 1f: Berechne den Mittelwert (Durchschnitt)

mean(species_counts)

# 1g: Calculate mean of your tree heights
# 1g: Berechne den Mittelwert deiner Baumh√∂hen

mean(___)
```

<div class="hint">
<span class="en">Hint: `c()` combines values into a vector. Use commas between values!</span>
<span class="de">Hinweis: `c()` kombiniert Werte zu einem Vektor. Benutze Kommas zwischen den Werten!</span>
</div>

---

# <span class="en">Exercise 2: The Magic of unique()</span><span class="de">√úbung 2: Die Magie von unique()</span>

<div class="en">

`unique()` is the **key function** for ecology! It tells us how many *different* species we found.

</div>

<div class="de">

`unique()` ist die **Schl√ºsselfunktion** f√ºr √ñkologie! Sie sagt uns, wie viele *verschiedene* Arten wir gefunden haben.

</div>

```{r}
# 2a: We observed these species (some repeats!)
# 2a: Wir haben diese Arten beobachtet (einige Wiederholungen!)

observations <- c("Oak", "Beech", "Oak", "Pine", "Beech", "Oak", "Maple")

# How many observations total?
# Wie viele Beobachtungen insgesamt?

length(observations)

# 2b: How many UNIQUE species?
# 2b: Wie viele EINZIGARTIGE Arten?

unique(observations)
length(unique(observations))

# 2c: Species from 3 plots
# 2c: Arten von 3 Plots

plot1 <- c("Oak", "Beech", "Pine")
plot2 <- c("Beech", "Maple", "Oak")
plot3 <- c("Birch", "Oak", "Ash")

# Combine all observations
# Kombiniere alle Beobachtungen

all_species <- c(plot1, plot2, plot3)
all_species

# 2d: Total observations vs unique species
# 2d: Gesamte Beobachtungen vs einzigartige Arten

length(all_species)           # Total observations / Gesamte Beobachtungen
length(unique(all_species))   # Species richness / Artenreichtum

# 2e: Your turn - how many unique species after adding plot1 + plot2?
# 2e: Du bist dran - wie viele einzigartige Arten nach plot1 + plot2?

after_two_plots <- c(plot1, ___)
length(unique(after_two_plots))
```

<div class="hint">
<span class="en">Hint: Species richness = `length(unique(species_list))`</span>
<span class="de">Hinweis: Artenreichtum = `length(unique(artenliste))`</span>
</div>

---

# <span class="en">Exercise 3: Data Frames</span><span class="de">√úbung 3: Data Frames</span>

<div class="en">

A **data frame** is like a spreadsheet - it has rows and columns. Let's practice with a small example before loading real data!

</div>

<div class="de">

Ein **Data Frame** ist wie eine Tabelle - er hat Zeilen und Spalten. √úben wir mit einem kleinen Beispiel, bevor wir echte Daten laden!

</div>

```{r}
# 3a: Create a simple data frame
# 3a: Erstelle einen einfachen Data Frame

my_data <- data.frame(
  species = c("Oak", "Beech", "Pine", "Maple"),
  height = c(20, 18, 25, 15),
  native = c(TRUE, TRUE, TRUE, FALSE)
)

my_data

# 3b: How many rows and columns?
# 3b: Wie viele Zeilen und Spalten?

nrow(my_data)
ncol(my_data)

# 3c: Access a column with $
# 3c: Greife auf eine Spalte mit $ zu

my_data$species
my_data$height

# 3d: Your turn - get the mean height
# 3d: Du bist dran - berechne die mittlere H√∂he

mean(my_data$___)

# 3e: Access a specific row (row 2)
# 3e: Greife auf eine bestimmte Zeile zu (Zeile 2)

my_data[2, ]

# 3f: Access a specific cell (row 2, column "height")
# 3f: Greife auf eine bestimmte Zelle zu (Zeile 2, Spalte "height")

my_data[2, "height"]
```

<div class="hint">
<span class="en">Hint: `$` accesses columns by name. Square brackets `[row, column]` access specific cells.</span>
<span class="de">Hinweis: `$` greift auf Spalten per Name zu. Eckige Klammern `[zeile, spalte]` greifen auf bestimmte Zellen zu.</span>
</div>

---

# <span class="en">Exercise 4: Loading Real Data</span><span class="de">√úbung 4: Echte Daten laden</span>

<div class="en">

Now let's load the **Austrian vegetation data**!

</div>

<div class="de">

Jetzt laden wir die **√∂sterreichischen Vegetationsdaten**!

</div>

```{r}
# 4a: Load the tidyverse package
# 4a: Lade das tidyverse Paket

library(tidyverse)

# 4b: Load the species data
# 4b: Lade die Artdaten

species_data <- read_csv("../data/austria_species.csv")

# 4c: Look at the first few rows
# 4c: Schau dir die ersten Zeilen an

head(species_data)

# 4d: How many rows (observations)?
# 4d: Wie viele Zeilen (Beobachtungen)?

nrow(species_data)

# 4e: What columns do we have?
# 4e: Welche Spalten haben wir?

colnames(species_data)

# 4f: How many unique plots?
# 4f: Wie viele einzigartige Plots?

length(unique(species_data$PlotObservationID))

# 4g: How many unique species in the whole dataset?
# 4g: Wie viele einzigartige Arten im gesamten Datensatz?

length(unique(species_data$___))
```

<div class="hint">
<span class="en">Hint: Use `$` to access a column, e.g. `data$column_name`</span>
<span class="de">Hinweis: Benutze `$` um auf eine Spalte zuzugreifen, z.B. `data$spaltenname`</span>
</div>

---

# <span class="en">Exercise 5: Filtering Data</span><span class="de">√úbung 5: Daten filtern</span>

<div class="en">

Often we want to look at only **part** of our data. The `filter()` function helps us select specific rows!

</div>

<div class="de">

Oft wollen wir nur einen **Teil** unserer Daten betrachten. Die `filter()` Funktion hilft uns, bestimmte Zeilen auszuw√§hlen!

</div>

```{r}
# 5a: Look at the STATUS column - what values are there?
# 5a: Schau dir die STATUS-Spalte an - welche Werte gibt es?

unique(species_data$STATUS)

# 5b: Filter for native species only (STATUS == "nat")
# 5b: Filtere nur heimische Arten (STATUS == "nat")

native_only <- species_data %>%
  filter(STATUS == "nat")

nrow(native_only)

# 5c: Filter for alien/invasive species (STATUS == "neo")
# 5c: Filtere Alien/invasive Arten (STATUS == "neo")

alien_only <- species_data %>%
  filter(STATUS == "neo")

nrow(alien_only)

# 5d: How many unique native species?
# 5d: Wie viele einzigartige heimische Arten?

length(unique(native_only$WFO_TAXON))

# 5e: Your turn - how many unique alien species?
# 5e: Du bist dran - wie viele einzigartige Alien-Arten?

length(unique(___$WFO_TAXON))

# 5f: Filter for a specific plot
# 5f: Filtere einen bestimmten Plot

first_plot <- unique(species_data$PlotObservationID)[1]
first_plot

one_plot <- species_data %>%
  filter(PlotObservationID == first_plot)

# How many species in this one plot?
# Wie viele Arten in diesem einen Plot?

length(unique(one_plot$WFO_TAXON))
```

<div class="hint">
<span class="en">Hint: `filter()` keeps rows where the condition is TRUE. Use `==` for "equals".</span>
<span class="de">Hinweis: `filter()` beh√§lt Zeilen, wo die Bedingung TRUE ist. Benutze `==` f√ºr "gleich".</span>
</div>

---

# <span class="en">Exercise 6: Building the Accumulation Curve</span><span class="de">√úbung 6: Die Akkumulationskurve bauen</span>

<div class="en">

Now the exciting part - let's build a species accumulation curve step by step!

</div>

<div class="de">

Jetzt der spannende Teil - bauen wir eine Artenakkumulationskurve Schritt f√ºr Schritt!

</div>

```{r}
# 6a: Get a list of all unique plots
# 6a: Hole eine Liste aller einzigartigen Plots

all_plots <- unique(species_data$PlotObservationID)
head(all_plots)

# 6b: Take a small sample (first 50 plots for speed)
# 6b: Nimm eine kleine Stichprobe (erste 50 Plots f√ºr Geschwindigkeit)

sample_plots <- all_plots[1:50]

# 6c: Initialize our accumulation tracking
# 6c: Initialisiere unsere Akkumulations-Verfolgung

species_found <- c()           # Empty vector to collect species
                               # Leerer Vektor um Arten zu sammeln
accumulation <- c()            # Will store species count after each plot
                               # Speichert Artenzahl nach jedem Plot

# 6d: Loop through each plot and count species!
# 6d: Schleife durch jeden Plot und z√§hle Arten!

for (i in 1:length(sample_plots)) {

  # Get current plot ID
  # Hole aktuelle Plot-ID
  current_plot <- sample_plots[i]

  # Get species in this plot
  # Hole Arten in diesem Plot
  plot_species <- species_data$WFO_TAXON[species_data$PlotObservationID == current_plot]

  # Add to our collection
  # F√ºge zu unserer Sammlung hinzu
  species_found <- c(species_found, plot_species)

  # Count unique species so far
  # Z√§hle einzigartige Arten bisher
  total_species <- length(unique(species_found))

  # Store in accumulation vector
  # Speichere im Akkumulationsvektor
  accumulation <- c(accumulation, total_species)
}

# 6e: Look at the result!
# 6e: Schau dir das Ergebnis an!

accumulation
```

---

# <span class="en">Exercise 7: Plot Your Curve!</span><span class="de">√úbung 7: Zeichne deine Kurve!</span>

<div class="en">

The final step - let's visualize our accumulation curve!

</div>

<div class="de">

Der letzte Schritt - visualisieren wir unsere Akkumulationskurve!

</div>

```{r}
# 7a: Create a data frame for plotting
# 7a: Erstelle einen Data Frame zum Plotten

curve_data <- data.frame(
  plots = 1:length(accumulation),
  species = accumulation
)

head(curve_data)

# 7b: Make the plot!
# 7b: Mache den Plot!

ggplot(curve_data, aes(x = plots, y = species)) +
  geom_line(color = "#2E7D32", linewidth = 2) +
  geom_point(color = "#2E7D32", size = 2) +
  labs(
    title = "My First Species Accumulation Curve!",
    x = "Number of Plots Sampled",
    y = "Cumulative Species Count"
  ) +
  theme_minimal(base_size = 14)

# 7c: Make it prettier with a filled area
# 7c: Mache es sch√∂ner mit gef√ºllter Fl√§che

ggplot(curve_data, aes(x = plots, y = species)) +
  geom_area(fill = "#C8E6C9", alpha = 0.5) +
  geom_line(color = "#2E7D32", linewidth = 2) +
  labs(
    title = "Species Accumulation Curve - Austria",
    subtitle = paste("Total species found:", max(accumulation)),
    x = "Plots Sampled",
    y = "Cumulative Species"
  ) +
  theme_minimal(base_size = 14)
```

<div class="hint">
<span class="en">Hint: The curve flattens because we find fewer NEW species as we sample more plots!</span>
<span class="de">Hinweis: Die Kurve flacht ab, weil wir weniger NEUE Arten finden, je mehr Plots wir untersuchen!</span>
</div>

---

# <span class="en">Bonus: Compare Native vs Alien!</span><span class="de">Bonus: Vergleiche Heimisch vs Alien!</span>

<div class="en">

If you finish early, try comparing native and alien species!

</div>

<div class="de">

Wenn du fr√ºh fertig bist, versuche heimische und Alien-Arten zu vergleichen!

</div>

```{r}
# The species_data already has a STATUS column!
# Die species_data hat bereits eine STATUS-Spalte!

# Filter for native species only
# Filtere nur heimische Arten

native_species <- species_data %>%
  filter(STATUS == "nat")

# How many native species?
# Wie viele heimische Arten?

length(unique(native_species$WFO_TAXON))

# How many alien species?
# Wie viele Alien-Arten?

alien_species <- species_data %>%
  filter(STATUS == "neo")

length(unique(alien_species$WFO_TAXON))

# Now you can build separate curves for native vs alien!
# Jetzt kannst du separate Kurven f√ºr heimisch vs alien bauen!
```

---

<div class="en">

**You did it!** You built your first species accumulation curve using real Austrian data!

**Key concepts learned:**
- Variables store data with `<-`
- `c()` creates vectors
- `unique()` counts different values
- Data frames organize data in rows and columns
- `filter()` selects specific rows
- Loops let us repeat actions
- `ggplot()` creates beautiful plots

</div>

<div class="de">

**Du hast es geschafft!** Du hast deine erste Artenakkumulationskurve mit echten √∂sterreichischen Daten gebaut!

**Gelernte Schl√ºsselkonzepte:**
- Variablen speichern Daten mit `<-`
- `c()` erstellt Vektoren
- `unique()` z√§hlt verschiedene Werte
- Data Frames organisieren Daten in Zeilen und Spalten
- `filter()` w√§hlt bestimmte Zeilen aus
- Schleifen lassen uns Aktionen wiederholen
- `ggplot()` erstellt sch√∂ne Plots

</div>
