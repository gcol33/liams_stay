---
title: '<span class="en">Day 1: Solutions</span><span class="de">Tag 1: Lösungen</span>'
subtitle: '<span class="en">Your First Accumulation Curve!</span><span class="de">Deine erste Akkumulationskurve!</span>'
author: '<span class="en">Answer Key</span><span class="de">Lösungsschlüssel</span>'
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
    self_contained: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, message = FALSE, warning = FALSE)
```

```{=html}
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.7; background-color: #fafffe; }
h1 { color: #2E7D32 !important; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
h2 { color: #388E3C !important; margin-top: 2em; }
h3 { color: #43A047 !important; }
pre { background-color: #f5f5f5 !important; border-left: 4px solid #4CAF50 !important; padding: 15px; border-radius: 8px; }
code { background-color: #E8F5E9; padding: 2px 6px; border-radius: 4px; color: #2E7D32; }
pre code { background-color: transparent; padding: 0; }
blockquote { border-left: 4px solid #FF9800; background-color: #FFF8E1; padding: 15px 20px; margin: 1em 0; border-radius: 0 8px 8px 0; }
hr { border: none; height: 3px; background: linear-gradient(to right, #4CAF50, #81C784, #C8E6C9, #81C784, #4CAF50); margin: 2em 0; }
.tocify { border: none !important; border-radius: 12px !important; background-color: #f1f8e9 !important; }
.tocify-item.active { background-color: #4CAF50 !important; color: white !important; }

.lang-toggle { position: fixed; top: 10px; right: 20px; z-index: 9999; background: linear-gradient(135deg, #2E7D32, #4CAF50); padding: 8px 12px; border-radius: 25px; }
.lang-toggle button { background: transparent; border: none; color: #fff; padding: 6px 14px; cursor: pointer; font-weight: bold; border-radius: 20px; font-size: 14px; }
.lang-toggle button.active { background: white; color: #2E7D32; }
.de { display: none; } .en { display: inline; }
body.lang-de .de { display: inline; } body.lang-de .en { display: none; }
div.de, p.de, li.de, h1.de, h2.de, h3.de, section.de { display: none; }
div.en, p.en, li.en, h1.en, h2.en, h3.en, section.en { display: block; }
body.lang-de div.de, body.lang-de p.de, body.lang-de li.de, body.lang-de h1.de, body.lang-de h2.de, body.lang-de h3.de, body.lang-de section.de { display: block; }
body.lang-de div.en, body.lang-de p.en, body.lang-de li.en, body.lang-de h1.en, body.lang-de h2.en, body.lang-de h3.en, body.lang-de section.en { display: none; }
body.lang-de #TOC .en { display: none; } body.lang-de #TOC .de { display: inline; }
#TOC .de { display: none; } #TOC .en { display: inline; }

@media (max-width: 768px) {
  body { font-size: 14px; }
  pre { font-size: 11px; padding: 10px; }
}
</style>
```

```{=html}
<script>
$(document).ready(function() {
  var toggle = $('<div class="lang-toggle"><button id="btn-en" class="active">EN</button><button id="btn-de">DE</button></div>');
  $('body').append(toggle);
  var savedLang = localStorage.getItem('workshop-lang');
  var defaultLang = savedLang || (navigator.language.substring(0, 2) === 'de' ? 'de' : 'en');
  function setLanguage(lang) {
    $('body').removeClass('lang-en lang-de').addClass('lang-' + lang);
    $('#btn-en').toggleClass('active', lang === 'en');
    $('#btn-de').toggleClass('active', lang === 'de');
    localStorage.setItem('workshop-lang', lang);
  }
  if (defaultLang === 'de') setLanguage('de');
  $('#btn-en').click(function() { setLanguage('en'); });
  $('#btn-de').click(function() { setLanguage('de'); });
});
</script>
```

---

# <span class="en">Exercise 1: Variables & Vectors</span><span class="de">Übung 1: Variablen & Vektoren</span>

```{r}
# 1a: Store a number in a variable
my_number <- 42
my_number

# 1b: Store text (needs quotes!)
my_name <- "Liam"
my_name

# 1c: Create a vector with c()
species_counts <- c(5, 3, 7, 2, 4)
species_counts

# 1d: Create a vector of 4 tree heights
tree_heights <- c(15, 22, 18, 25)
tree_heights

# 1e: Get the length of a vector
length(species_counts)

# 1f: Calculate mean (average)
mean(species_counts)

# 1g: Calculate mean of tree heights
mean(tree_heights)
```

---

# <span class="en">Exercise 2: The Magic of unique()</span><span class="de">Übung 2: Die Magie von unique()</span>

```{r}
# 2a: Observations with repeats
observations <- c("Oak", "Beech", "Oak", "Pine", "Beech", "Oak", "Maple")
length(observations)

# 2b: Unique species
unique(observations)
length(unique(observations))

# 2c: Species from 3 plots
plot1 <- c("Oak", "Beech", "Pine")
plot2 <- c("Beech", "Maple", "Oak")
plot3 <- c("Birch", "Oak", "Ash")

all_species <- c(plot1, plot2, plot3)
all_species

# 2d: Total vs unique
length(all_species)
length(unique(all_species))

# 2e: After plot1 + plot2
after_two_plots <- c(plot1, plot2)
length(unique(after_two_plots))
```

---

# <span class="en">Exercise 3: Data Frames</span><span class="de">Übung 3: Data Frames</span>

```{r}
# 3a: Create a simple data frame
my_data <- data.frame(
  species = c("Oak", "Beech", "Pine", "Maple"),
  height = c(20, 18, 25, 15),
  native = c(TRUE, TRUE, TRUE, FALSE)
)

my_data

# 3b: How many rows and columns?
nrow(my_data)
ncol(my_data)

# 3c: Access a column with $
my_data$species
my_data$height

# 3d: Get the mean height
mean(my_data$height)

# 3e: Access a specific row (row 2)
my_data[2, ]

# 3f: Access a specific cell (row 2, column "height")
my_data[2, "height"]
```

---

# <span class="en">Exercise 4: Loading Real Data</span><span class="de">Übung 4: Echte Daten laden</span>

```{r}
library(tidyverse)

species_data <- read_csv("../data/austria_species.csv")

head(species_data)

nrow(species_data)

colnames(species_data)

length(unique(species_data$PlotObservationID))

length(unique(species_data$WFO_TAXON))
```

---

# <span class="en">Exercise 5: Filtering Data</span><span class="de">Übung 5: Daten filtern</span>

```{r}
# 5a: Look at the STATUS column
unique(species_data$STATUS)

# 5b: Filter for native species only
native_only <- species_data %>%
  filter(STATUS == "nat")

nrow(native_only)

# 5c: Filter for alien/invasive species
alien_only <- species_data %>%
  filter(STATUS == "neo")

nrow(alien_only)

# 5d: How many unique native species?
length(unique(native_only$WFO_TAXON))

# 5e: How many unique alien species?
length(unique(alien_only$WFO_TAXON))

# 5f: Filter for a specific plot
first_plot <- unique(species_data$PlotObservationID)[1]
first_plot

one_plot <- species_data %>%
  filter(PlotObservationID == first_plot)

# How many species in this one plot?
length(unique(one_plot$WFO_TAXON))
```

---

# <span class="en">Exercise 6: Building the Accumulation Curve</span><span class="de">Übung 6: Die Akkumulationskurve bauen</span>

```{r}
# Get all unique plots
all_plots <- unique(species_data$PlotObservationID)

# Take first 50 for speed
sample_plots <- all_plots[1:50]

# Initialize
species_found <- c()
accumulation <- c()

# Loop through each plot
for (i in 1:length(sample_plots)) {
  current_plot <- sample_plots[i]
  plot_species <- species_data$WFO_TAXON[species_data$PlotObservationID == current_plot]
  species_found <- c(species_found, plot_species)
  total_species <- length(unique(species_found))
  accumulation <- c(accumulation, total_species)
}

# Result
accumulation
```

---

# <span class="en">Exercise 7: Plot Your Curve!</span><span class="de">Übung 7: Zeichne deine Kurve!</span>

```{r}
# Create data frame
curve_data <- data.frame(
  plots = 1:length(accumulation),
  species = accumulation
)

head(curve_data)

# Basic plot
ggplot(curve_data, aes(x = plots, y = species)) +
  geom_line(color = "#2E7D32", linewidth = 2) +
  geom_point(color = "#2E7D32", size = 2) +
  labs(
    title = "My First Species Accumulation Curve!",
    x = "Number of Plots Sampled",
    y = "Cumulative Species Count"
  ) +
  theme_minimal(base_size = 14)

# Pretty version with filled area
ggplot(curve_data, aes(x = plots, y = species)) +
  geom_area(fill = "#C8E6C9", alpha = 0.5) +
  geom_line(color = "#2E7D32", linewidth = 2) +
  labs(
    title = "Species Accumulation Curve - Austria",
    subtitle = paste("Total species found:", max(accumulation)),
    x = "Plots Sampled",
    y = "Cumulative Species"
  ) +
  theme_minimal(base_size = 14)
```

---

# <span class="en">Bonus: Compare Native vs Alien!</span><span class="de">Bonus: Vergleiche Heimisch vs Alien!</span>

```{r}
# Filter for native species only
native_species <- species_data %>%
  filter(STATUS == "nat")

length(unique(native_species$WFO_TAXON))

# Filter for alien species
alien_species <- species_data %>%
  filter(STATUS == "neo")

length(unique(alien_species$WFO_TAXON))
```

---

<div class="en">

**Key concepts learned:**

- Variables store data with `<-`
- `c()` creates vectors
- `unique()` counts different values
- Data frames organize data in rows and columns
- `filter()` selects specific rows
- Loops repeat actions for each plot
- `ggplot()` creates visualizations

</div>

<div class="de">

**Gelernte Schlüsselkonzepte:**

- Variablen speichern Daten mit `<-`
- `c()` erstellt Vektoren
- `unique()` zählt verschiedene Werte
- Data Frames organisieren Daten in Zeilen und Spalten
- `filter()` wählt bestimmte Zeilen aus
- Schleifen wiederholen Aktionen für jeden Plot
- `ggplot()` erstellt Visualisierungen

</div>
