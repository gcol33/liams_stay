---
title: '<span class="en">Day 3: Key Findings from the Austrian Vegetation Data</span><span class="de">Tag 3: Wichtigste Ergebnisse aus den österreichischen Vegetationsdaten</span>'
subtitle: '<span class="en">What the spacc analysis tells us</span><span class="de">Was uns die spacc-Analyse verrät</span>'
author: "Liam's Stay - Results"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    theme: flatly
    self_contained: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, message = FALSE, warning = FALSE,
  fig.width = 10, fig.height = 6
)
library(ggplot2)
library(data.table)
library(spacc)
library(sf)
library(rnaturalearth)
library(hexify)

comp_dir  <- file.path(dirname(getwd()), "comp")
data_path <- file.path(dirname(getwd()), "data")
```

```{css, echo=FALSE}
/* ========== WORKSHOP THEME ========== */

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  line-height: 1.7;
  background-color: #fafffe;
}

h1 { color: #2E7D32 !important; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
h2 { color: #388E3C !important; margin-top: 2em; }
h3 { color: #43A047 !important; }

table { border-collapse: collapse; margin: 1em 0; width: 100%; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
th { background-color: #4CAF50 !important; color: white !important; padding: 12px; text-align: left; }
td { padding: 10px 12px; border-bottom: 1px solid #ddd; }
tr:nth-child(even) { background-color: #f9f9f9; }
tr:hover { background-color: #E8F5E9; }

blockquote { border-left: 4px solid #FF9800; background-color: #FFF8E1; padding: 15px 20px; margin: 1em 0; border-radius: 0 8px 8px 0; }

hr { border: none; height: 3px; background: linear-gradient(to right, #4CAF50, #81C784, #C8E6C9, #81C784, #4CAF50); margin: 2em 0; border-radius: 2px; }

.tocify { border: none !important; border-radius: 12px !important; background-color: #f1f8e9 !important; }
.tocify-item.active { background-color: #4CAF50 !important; color: white !important; }

/* Hypothesis boxes */
.hypothesis-box {
  background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
  border-left: 5px solid #FF9800;
  padding: 20px;
  margin: 1.5em 0;
  border-radius: 0 12px 12px 0;
}

/* Results boxes */
.results-box {
  background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
  border-left: 5px solid #4CAF50;
  padding: 20px;
  margin: 1.5em 0;
  border-radius: 0 12px 12px 0;
}

/* Theory boxes */
.theory-box {
  background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
  border-left: 5px solid #4CAF50;
  padding: 20px;
  margin: 1.5em 0;
  border-radius: 0 12px 12px 0;
}

/* Discussion boxes (new) */
.discussion-box {
  background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
  border-left: 5px solid #1976D2;
  padding: 20px;
  margin: 1.5em 0;
  border-radius: 0 12px 12px 0;
}

/* Literature boxes */
.lit-box {
  background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%);
  border-left: 5px solid #7B1FA2;
  padding: 20px;
  margin: 1.5em 0;
  border-radius: 0 12px 12px 0;
  font-size: 0.92em;
}

/* Math formula display fix */
.MathJax, .MathJax_Display, .mjx-chtml {
  overflow: visible !important;
  padding: 5px 0 !important;
}
p:has(.MathJax) {
  overflow: visible;
  line-height: 2.5;
}

/* ========== LANGUAGE TOGGLE ========== */
.lang-toggle {
  position: fixed; top: 10px; right: 20px; z-index: 9999;
  background: linear-gradient(135deg, #2E7D32, #4CAF50);
  padding: 8px 12px; border-radius: 25px;
  box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
}
.lang-toggle button {
  background: transparent; border: none; color: #fff;
  padding: 6px 14px; cursor: pointer; font-weight: bold;
  border-radius: 20px; transition: all 0.3s; font-size: 14px;
}
.lang-toggle button.active { background: white; color: #2E7D32; }
.lang-toggle button:hover:not(.active) { background: rgba(255,255,255,0.2); }

.de { display: none; }
.en { display: inline; }
body.lang-de .de { display: inline; }
body.lang-de .en { display: none; }

div.de, p.de, li.de, h1.de, h2.de, h3.de, h4.de, section.de { display: none; }
div.en, p.en, li.en, h1.en, h2.en, h3.en, h4.en, section.en { display: block; }

body.lang-de div.de, body.lang-de p.de, body.lang-de li.de,
body.lang-de h1.de, body.lang-de h2.de, body.lang-de h3.de,
body.lang-de h4.de, body.lang-de section.de { display: block; }

body.lang-de div.en, body.lang-de p.en, body.lang-de li.en,
body.lang-de h1.en, body.lang-de h2.en, body.lang-de h3.en,
body.lang-de h4.en, body.lang-de section.en { display: none; }

body.lang-de #TOC .en { display: none; }
body.lang-de #TOC .de { display: inline; }
#TOC .de { display: none; }
#TOC .en { display: inline; }

@media print {
  .tocify, .lang-toggle { display: none; }
}

/* ========== MOBILE RESPONSIVE ========== */
@media (max-width: 768px) {
  body { font-size: 14px; line-height: 1.5; }
  h1 { font-size: 1.5rem; }
  h2 { font-size: 1.3rem; }
  h3 { font-size: 1.1rem; }
  .lang-toggle { top: 5px; right: 10px; padding: 5px 8px; }
  .lang-toggle button { padding: 4px 10px; font-size: 12px; }
  table { font-size: 12px; display: block; overflow-x: auto; white-space: nowrap; }
  th, td { padding: 6px 8px; }
  blockquote { padding: 10px 15px; margin: 0.5em 0; }
  pre { font-size: 11px; padding: 10px; }
  code { font-size: 11px; }
  img, .figure img { max-width: 100%; height: auto; }
}
```

```{js, echo=FALSE}
document.addEventListener('DOMContentLoaded', function() {
  var toggle = document.createElement('div');
  toggle.className = 'lang-toggle';
  toggle.innerHTML = '<button id="btn-en" class="active">EN</button><button id="btn-de">DE</button>';
  document.body.appendChild(toggle);

  var savedLang = localStorage.getItem('workshop-lang');
  var browserLang = navigator.language.substring(0, 2);
  var defaultLang = savedLang || (browserLang === 'de' ? 'de' : 'en');
  if (defaultLang === 'de') setLanguage('de');

  document.getElementById('btn-en').addEventListener('click', function() { setLanguage('en'); });
  document.getElementById('btn-de').addEventListener('click', function() { setLanguage('de'); });

  function setLanguage(lang) {
    document.body.classList.remove('lang-en', 'lang-de');
    document.body.classList.add('lang-' + lang);
    document.getElementById('btn-en').classList.toggle('active', lang === 'en');
    document.getElementById('btn-de').classList.toggle('active', lang === 'de');
    localStorage.setItem('workshop-lang', lang);
  }
});
```

---

```{r load-data}
header  <- fread(file.path(data_path, "austria_header.csv"))
species <- fread(file.path(data_path, "austria_species.csv"))

common_ids <- intersect(header$PlotObservationID, species$PlotObservationID)
header <- header[PlotObservationID %in% common_ids]
header[, decade := ifelse(Year < 1970, "pre-1970",
                          paste0(floor(Year / 10) * 10, "s"))]

n_plots   <- nrow(header)
n_records <- nrow(species)
n_species <- uniqueN(species$WFO_TAXON)
n_native  <- uniqueN(species[STATUS == "native"]$WFO_TAXON)
n_alien   <- uniqueN(species[STATUS == "neo"]$WFO_TAXON)
```

# <span class="en">Overview</span><span class="de">Überblick</span>

<div class="en">

This document presents **five key findings** from our analysis of ~`r format(n_plots, big.mark = ",")` Austrian vegetation plots (EVA database). Each finding includes figures and a discussion linking the results to ecological theory and conservation.

These five findings were chosen because they each address a different aspect of Austrian plant diversity:

| # | Finding | Why it matters |
|---|---------|----------------|
| 1 | **Sampling & richness overview** — Hotspot maps | Where was data collected and what does raw richness look like? |
| 2 | **How species accumulate** — Native vs. alien curves | The central hypothesis: different spatial strategies |
| 3 | **How much we're missing** — Invasion debt | The future of Austria's alien flora |
| 4 | **Why sites differ** — Turnover vs. nestedness | What drives Austria's high beta diversity |
| 5 | **Which habitats are vulnerable** — Habitat-level invasion | Where conservation efforts should focus |

</div>

<div class="de">

Dieses Dokument destilliert die **fünf überzeugendsten Ergebnisse** aus unserer umfassenden Analyse von ~`r format(n_plots, big.mark = ",")` österreichischen Vegetationsplots. Jedes Ergebnis wird mit seiner Abbildung präsentiert, gefolgt von einer erweiterten Diskussion, die das Ergebnis mit breiterer ökologischer Theorie, Naturschutzpraxis und offenen Fragen verbindet.

Die fünf Ergebnisse wurden ausgewählt, weil sie jeweils einen eigenständigen Teil der österreichischen Biodiversitätsgeschichte erzählen:

| # | Ergebnis | Warum es wichtig ist |
|---|----------|---------------------|
| 1 | **Beprobung & Artenreichtum** — Hotspot-Karten | Wo wurde beprobt und wie sieht der beobachtete Artenreichtum aus? |
| 2 | **Wie Arten akkumulieren** — Heimische vs. Alien-Kurven | Die zentrale Hypothese: verschiedene räumliche Strategien |
| 3 | **Was uns fehlt** — Invasionsschuld | Die Zukunft von Österreichs Alien-Flora |
| 4 | **Warum sich Standorte unterscheiden** — Turnover vs. Nestedness | Was Österreichs hohe Beta-Diversität antreibt |
| 5 | **Welche Habitate verwundbar sind** — Habitat-Invasionsmuster | Wo Naturschutzbemühungen fokussieren sollten |

</div>

---

# <span class="en">1. Sampling & Richness Overview: Hotspot Maps</span><span class="de">1. Beprobung & Artenreichtum: Hotspot-Karten</span>

## <span class="en">The Maps</span><span class="de">Die Karten</span>

```{r hotspot-data}
austria_sf <- ne_countries(scale = "medium", country = "Austria", returnclass = "sf")

plot_richness <- species[, .(
  n_native = uniqueN(WFO_TAXON[STATUS == "native"]),
  n_alien  = uniqueN(WFO_TAXON[STATUS == "neo"])
), by = PlotObservationID]

plot_richness[, total := n_native + n_alien]
plot_richness[, alien_pct := ifelse(total > 0, 100 * n_alien / total, 0)]

plot_rich_geo <- merge(plot_richness,
                       header[, .(PlotObservationID, Longitude, Latitude)],
                       by = "PlotObservationID")

grid <- hex_grid(area_km2 = 750)
hex_data <- hexify(plot_rich_geo, grid = grid, lon = "Longitude", lat = "Latitude")

hex_df <- as.data.frame(hex_data)
hex_summary <- as.data.table(hex_df)[, .(
  mean_native    = mean(n_native, na.rm = TRUE),
  mean_alien     = mean(n_alien, na.rm = TRUE),
  mean_alien_pct = mean(alien_pct, na.rm = TRUE),
  n_plots        = .N
), by = cell_id]

hex_summary <- hex_summary[n_plots >= 3]
hex_polys <- cell_to_sf(hex_summary$cell_id, grid = grid)
hex_polys <- merge(hex_polys, hex_summary, by = "cell_id")
```

```{r hotspot-native, fig.height=5.5}
ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_polys, aes(fill = mean_native), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_gradient(low = "white", high = "#2E7D32",
                      name = "Mean native\nrichness") +
  labs(title = "Native Species Richness Hotspots / Heimische Arten Hotspots",
       subtitle = "Mean species per plot, equal-area hexagonal grid (min. 3 plots)",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))
```

```{r hotspot-alien, fig.height=5.5}
ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_polys, aes(fill = mean_alien), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_gradient(low = "white", high = "#D32F2F",
                      name = "Mean alien\nrichness") +
  labs(title = "Alien Species Richness Hotspots / Alien-Arten Hotspots",
       subtitle = "Mean alien species per plot, equal-area hexagonal grid",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))
```

```{r hotspot-alien-pct, fig.height=5.5}
ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_polys, aes(fill = mean_alien_pct), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_distiller(palette = "YlOrRd", direction = 1,
                       name = "Alien %") +
  labs(title = "Alien Species Proportion / Alien-Artenanteil",
       subtitle = "Mean % alien species per plot",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))
```

## <span class="en">Discussion</span><span class="de">Diskussion</span>

<div class="discussion-box">

<div class="en">

**What the maps show:**

Native and alien plant richness follow different spatial rules in Austria. Native richness peaks in the pre-Alpine foothills and montane zones, where overlapping vegetation belts create high habitat variety. Alien richness concentrates in the eastern lowlands, the Danube corridor, and around cities.

**Why they peak in different places:**

Native richness reflects topographic complexity. Between 500 and 1500 m, multiple vegetation zones converge (sub-montane deciduous forests, montane coniferous forests, sub-alpine meadows), creating high local richness through niche partitioning along temperature, moisture, and soil gradients (Rahbek 1995). The mid-elevation diversity peak is one of the best-documented patterns in mountain ecology.

Alien species need **introduction pathways**: trade routes, transport infrastructure, gardens, agricultural imports. These converge on cities and lowland corridors. The Danube valley acts as a continental dispersal highway; Vienna has been a gateway for ornamental and crop-associated aliens since the 18th century. The Pannonian Basin adds warm, continental conditions that suit thermophilic aliens from southern Europe and Asia.

**The proportion map matters most:**

Absolute richness maps can be confounded by sampling intensity. The alien *proportion* map corrects for this. The clear east-west gradient confirms the invasion pattern is real, not a sampling artefact: aliens make up 10--15% of local flora in the Pannonian lowlands but stay below 2% in the Alpine core.

**Links to invasion theory:**

The spatial concentration around human infrastructure fits the **propagule pressure** hypothesis (Lockwood et al. 2005): invasion success depends on how many individuals arrive, not just species traits. It also fits the **fluctuating resource** hypothesis (Davis et al. 2000): disturbed, nutrient-enriched lowland habitats get regular resource pulses (tilling, fertilisation, construction) that open windows for alien establishment.

</div>

<div class="de">

**Was die Karten zeigen:**

Diese drei hexagonalen Heatmaps offenbaren eine auffällige räumliche Entkopplung zwischen heimischem und Alien-Pflanzenreichtum in Österreich. Der heimische Artenreichtum erreicht seinen Höhepunkt in den Voralpen und montanen Zonen, wo überlappende Vegetationsgürtel hohe Habitatheterogenität schaffen. Der Alien-Reichtum hingegen konzentriert sich in den östlichen Tieflagen, im Donaukorridor und um die großen Stadtzentren.

**Warum heimische und Alien-Arten an verschiedenen Orten ihre Höchstwerte erreichen:**

Das Muster des heimischen Reichtums spiegelt Österreichs topografische Komplexität wider. Zwischen 500 und 1500 m Höhe konvergieren mehrere Vegetationszonen: submontane Laubwälder, montane Nadelwälder und subalpine Wiesen. Diese Höhenkompression schafft hohen lokalen Artenreichtum durch Nischenaufteilung entlang von Temperatur-, Feuchtigkeits- und Bodengradienten (Rahbek 1995).

Das Alien-Muster erzählt eine andere Geschichte. Alien-Arten benötigen **Einführungswege**: Handelsrouten, Verkehrsinfrastruktur, Gärten, landwirtschaftliche Importe. Diese Wege konvergieren auf Städte und Tieflandkorridore. Das Donautal dient als kontinentale Ausbreitungsautobahn. Wien allein war seit dem 18. Jahrhundert ein Tor für ornamentale und kulturpflanzenassoziierte Aliens. Das Pannonische Becken in Ostösterreich bietet warme, kontinentale Bedingungen, die viele thermophile Alien-Arten aus Südeuropa und Asien begünstigen.

**Die Anteilskarte ist am informativsten:**

Während absolute Reichtumsarten durch Beprobungsintensität verfälscht werden können, kontrolliert die Alien-*Anteils*karte dies, indem sie Aliens als Bruchteil der Gesamtdiversität an jedem Standort ausdrückt. Der klare Ost-West-Gradient bestätigt, dass das Invasionsmuster kein Stichprobenartefakt ist. Im pannonischen Tiefland können Aliens 10--15% der lokalen Plot-Flora ausmachen, während sie im alpinen Kern unter 2% bleiben.

**Verbindungen zur Invasionstheorie:**

Die räumliche Konzentration von Aliens um menschliche Infrastruktur unterstützt die **Propagule-Pressure**-Hypothese (Lockwood et al. 2005): Invasionserfolg hängt nicht nur von Arteneigenschaften ab, sondern von der Rate, mit der Individuen ankommen. Die Verbindung zur **Hypothese der schwankenden Ressourcen** (Davis et al. 2000) liegt auf der Hand: gestörte, nährstoffangereicherte Tieflandhabitate erfahren regelmäßige Ressourcenpulse, die Invasionsfenster schaffen.

</div>

</div>

---

# <span class="en">2. The Central Finding: Aliens Accumulate Differently</span><span class="de">2. Das zentrale Ergebnis: Aliens akkumulieren anders</span>

## <span class="en">Native vs. Alien Accumulation Curves</span><span class="de">Heimische vs. Alien Akkumulationskurven</span>

```{r helper-functions}
# Normalized comparison plot for two spacc objects
plot_normalized <- function(..., title = "Species Accumulation Curves (normalized)",
                            ci = TRUE, ci_alpha = 0.3) {
  objs <- list(...)
  nms  <- names(objs)
  df_list <- lapply(seq_along(objs), function(i) {
    s <- summary(objs[[i]])
    total <- max(s$mean)
    data.frame(
      sites = s$sites, mean = s$mean / total,
      lower = s$lower / total, upper = s$upper / total, group = nms[i]
    )
  })
  df <- do.call(rbind, df_list)
  df$group <- factor(df$group, levels = nms)
  p <- ggplot(df, aes(x = sites, y = mean, color = group, fill = group))
  if (ci) p <- p + geom_ribbon(aes(ymin = lower, ymax = upper), alpha = ci_alpha, color = NA)
  p + geom_line(linewidth = 1) +
    scale_y_continuous(labels = scales::percent) +
    labs(x = "Sites sampled", y = "Proportion of total species",
         title = title, color = "Group", fill = "Group") +
    theme_minimal(base_size = 13)
}

# Normalized grouped plot
plot_grouped_normalized <- function(x, title = "Normalized Accumulation",
                                     ci = TRUE, ci_level = 0.95, ci_alpha = 0.3) {
  summaries <- summary(x, ci_level = ci_level)
  df_list <- lapply(names(summaries), function(g) {
    s <- summaries[[g]]
    if (length(s$sites) == 0) return(NULL)
    total <- max(s$mean)
    if (total == 0) return(NULL)
    data.frame(
      sites = s$sites, mean = s$mean / total,
      lower = s$lower / total, upper = s$upper / total, group = g
    )
  })
  df_list <- df_list[!vapply(df_list, is.null, logical(1))]
  df <- do.call(rbind, df_list)
  df$group <- factor(df$group)
  ggplot(df, aes(x = sites, y = mean, color = group, fill = group)) +
    { if (ci) geom_ribbon(aes(ymin = lower, ymax = upper), alpha = ci_alpha, color = NA) } +
    geom_line(linewidth = 1) +
    scale_y_continuous(labels = scales::percent) +
    scale_color_manual(values = c("native" = "#2E7D32", "neo" = "#D32F2F"),
                       labels = c("native" = "Native", "neo" = "Alien")) +
    scale_fill_manual(values = c("native" = "#2E7D32", "neo" = "#D32F2F"),
                      labels = c("native" = "Native", "neo" = "Alien")) +
    labs(x = "Sites sampled", y = "Proportion of total species",
         title = title, color = "Status", fill = "Status") +
    theme_minimal(base_size = 12)
}
```

```{r pooled-curves}
p <- readRDS(file.path(comp_dir, "pooled.rds"))
sac_native <- p$native; sac_alien <- p$alien; sac_all <- p$all
rm(p)

plot_normalized(Native = sac_native, Alien = sac_alien,
                title = "Pooled: Native vs Alien Accumulation (normalized)") +
  scale_color_manual(values = c("Native" = "#2E7D32", "Alien" = "#D32F2F")) +
  scale_fill_manual(values = c("Native" = "#2E7D32", "Alien" = "#D32F2F"))
```

```{r statistical-test}
compare <- readRDS(file.path(comp_dir, "compare.rds"))
print(compare)
plot(compare) +
  ggtitle("Permutation Test: Native vs Alien Curve Comparison") +
  theme_minimal(base_size = 13)
```

```{r grouped-status}
sac_grouped <- readRDS(file.path(comp_dir, "grouped_status.rds"))
plot_grouped_normalized(sac_grouped,
                        title = "Grouped by Status: Native vs Alien (1990s, normalized)") +
  scale_color_manual(values = c("native" = "#2E7D32", "neo" = "#D32F2F"),
                     labels = c("native" = "Native", "neo" = "Alien")) +
  scale_fill_manual(values = c("native" = "#2E7D32", "neo" = "#D32F2F"),
                    labels = c("native" = "Native", "neo" = "Alien"))
```

## <span class="en">Discussion</span><span class="de">Diskussion</span>

<div class="discussion-box">

<div class="en">

**The core result:**

After normalizing both curves to their respective totals, the alien curve sits consistently below the native curve. This means we discover a *smaller fraction* of alien species per unit area sampled than of native species. The permutation test confirms this (p < 0.05), and the grouped analysis (both groups accumulated along identical spatial paths) rules out confounding from different walk trajectories.

**What a lower normalized curve means:**

A lower curve = higher **spatial beta diversity**: species composition changes more between distant sites. Many native generalists (common grasses, widespread forest herbs) show up early in the walk and are shared across most of the country. After a few hundred plots from different regions, you've already seen 50--60% of natives. For aliens, each region has a partly different set, reflecting distinct introduction histories. A spatial walk through the Vienna Basin encounters different aliens than one through the Inn Valley.

**The multi-focus introduction model:**

Native species had millennia to reach equilibrium distributions shaped by climate and soil. Aliens arrived at specific introduction points at different times and from different source regions. Each point acts as a separate focus of local spread:

- **Eastern Austria**: Pannonian and Eurasian steppe aliens via the Danube
- **Western Austria**: Mediterranean aliens via the Brenner corridor
- **Southern Austria**: Balkan and sub-Mediterranean aliens via southern trade routes

Because each region got a partly different alien pool, you need to cover more ground to encounter the full set.

**Stability over time:**

The decade-by-decade analysis confirms this pattern holds from the 1970s to the 2010s. The alien curve shape does not converge toward the native shape, so alien floras are not homogenizing across Austria. At least not yet.

**For monitoring:**

A monitoring programme that samples only one region will underestimate alien diversity more than native diversity. To capture the same proportion of aliens as of natives, a monitoring network must cover more of Austria's geographic extent.

</div>

<div class="de">

**Das Kernergebnis:**

Wenn wir beide Kurven auf ihre jeweiligen Gesamtwerte normalisieren, liegt die Alien-Kurve konsistent unter der heimischen Kurve. Das bedeutet, dass wir beim Durchqueren der österreichischen Landschaft in räumlicher Reihenfolge bei jedem Schritt einen *kleineren Anteil* der Alien-Flora entdecken als der heimischen Flora. Der Permutationstest bestätigt, dass dieser Unterschied statistisch signifikant ist (p < 0,05), und die gruppierte Analyse (bei der beide Gruppen entlang exakt derselben räumlichen Pfade akkumuliert werden) eliminiert jeden Störeffekt verschiedener Walk-Trajektorien.

**Was bedeutet eine niedrigere normalisierte Kurve biologisch?**

Eine niedrigere normalisierte Kurve zeigt höhere **räumliche Beta-Diversität** an: Die Artenzusammensetzung ändert sich stärker zwischen entfernten Standorten. Bei Einheimischen erscheinen viele weit verbreitete Generalistenarten (häufige Gräser, weit verbreitete Waldkräuter) früh im räumlichen Walk und werden über weite Teile der Landschaft geteilt. Bei Aliens unterscheidet sich die Geschichte: Jede Region beherbergt eine teils unterschiedliche Menge an Aliens, was ihre verschiedenen Einführungsgeschichten und Habitatpräferenzen widerspiegelt.

**Das Multi-Fokus-Einführungsmodell:**

Dieses Muster wird am besten durch das **Multi-Fokus-Einführungsmodell** erklärt. Heimische Arten hatten Jahrtausende, um Gleichgewichtsverteilungen zu erreichen. Alien-Arten hingegen kamen an spezifischen Einführungspunkten (Häfen, Städte, Botanische Gärten, Agrargebiete) zu verschiedenen Zeiten und aus verschiedenen Quellregionen an:

- **Wien und Ostösterreich** erhielten pannonische und eurasische Steppenaliens durch den Donauhandel
- **Innsbruck und Westösterreich** erhielten mediterrane und Alpenpass-Aliens durch den Brennerkorridor
- **Graz und Südösterreich** erhielten balkanische und submediterrane Aliens durch südliche Handelsrouten

Da jede Region einen teils unterschiedlichen Alien-Artenpool erhielt, muss mehr der Landschaft durchquert werden, um das vollständige Komplement zu finden.

**Zeitliche Robustheit:**

Die jahrzehntweise Analyse bestätigt, dass dieses Muster über alle Beprobungszeiträume von den 1970ern bis zu den 2010ern stabil ist. Die Alien-Kurvenform konvergiert nicht zur heimischen Form, was darauf hindeutet, dass Alien-Arten die Landschaft (noch) nicht homogenisieren.

**Implikationen für das Monitoring:**

Wenn ein Monitoringprogramm nur eine einzelne Region beprobt, wird es die Alien-Diversität systematisch stärker unterschätzen als die heimische. Um denselben proportionalen Erfassungsgrad für Alien-Arten zu erreichen, muss ein Monitoringnetzwerk mehr von Österreichs geografischer Ausdehnung umfassen.

</div>

</div>

---

# <span class="en">3. The Invasion Debt: How Many Aliens Are We Missing?</span><span class="de">3. Die Invasionsschuld: Wie viele Aliens fehlen uns?</span>

## <span class="en">Michaelis-Menten Extrapolation</span><span class="de">Michaelis-Menten-Extrapolation</span>

<div class="theory-box">

<div class="en">

The **Michaelis-Menten model** fits a saturating curve to the species accumulation data:

$$S(n) = \frac{S_{max} \cdot n}{K_m + n}$$

where $S_{max}$ is the estimated total species richness (the asymptote) and $K_m$ is the half-saturation constant. The gap between the observed species count and the estimated $S_{max}$ represents **dark diversity** — species present in the region but not yet detected (Partel et al. 2011).

</div>

<div class="de">

Das **Michaelis-Menten-Modell** passt eine sättigende Kurve an die Artenakkumulationsdaten an:

$$S(n) = \frac{S_{max} \cdot n}{K_m + n}$$

wobei $S_{max}$ der geschätzte Gesamtartenreichtum (die Asymptote) und $K_m$ die Halbsättigungskonstante ist. Die Lücke zwischen der beobachteten Artenzahl und dem geschätzten $S_{max}$ repräsentiert **dunkle Diversität** — Arten, die in der Region vorhanden, aber noch nicht nachgewiesen sind (Partel et al. 2011).

</div>

</div>

```{r extrapolation}
e <- readRDS(file.path(comp_dir, "extrapolate.rds"))
fit_native <- e$native; fit_alien <- e$alien
rm(e)
```

```{r extrap-native, fig.height=5}
cat("Native species extrapolation:\n")
print(fit_native)
plot(fit_native) + ggtitle("Native Species: Observed vs Extrapolated")
```

```{r extrap-alien, fig.height=5}
cat("\nAlien species extrapolation:\n")
print(fit_alien)
plot(fit_alien) + ggtitle("Alien Species: Observed vs Extrapolated")
```

## <span class="en">Discussion</span><span class="de">Diskussion</span>

<div class="discussion-box">

<div class="en">

**The numbers:**

- **Native species:** ~2,378 observed out of ~2,525 estimated = **~94% completeness**
- **Alien species:** ~323 observed out of ~411 estimated = **~79% completeness**

The 15-point gap is one of the clearest results from the analysis. We don't just have fewer alien species; we're also proportionally further from knowing them all.

**Why is the alien flora less complete?**

Three mechanisms explain this:

1. **Ongoing introductions.** New aliens keep arriving through trade, horticulture, and climate-driven range shifts. Global alien plant accumulation shows no sign of saturating (Seebens et al. 2017). Some of the "missing" ~88 species may not have arrived yet.

2. **Dispersal lag.** Aliens already in Austria haven't reached all suitable habitats. A species introduced to a Viennese garden in the 1990s may take decades to colonize the Danube floodplains or the ruderal sites of Carinthia. With 52,000 plots spread unevenly, many early-stage colonizers are missed.

3. **Detection difficulty.** Some aliens are taxonomically tricky or occupy under-sampled habitats (urban wastelands, private gardens, industrial sites).

**Invasion debt:**

Essl et al. (2011) introduced the concept of **invasion debt** (by analogy with extinction debt): past introductions create a time-delayed wave of invasions. Our ~88 "missing" alien species represent the upper bound of this debt. Austria's alien flora is likely to grow by roughly 25% even without any new introductions.

**For conservation:**

Species lists are not static. Monitoring programmes should plan for a growing alien flora and focus early-detection surveys on high-risk habitats (urban fringes, transport corridors, river valleys).

**Model caveat:**

The Michaelis-Menten estimator assumes a specific functional form. If the accumulation curve has a long tail of very rare species, the asymptote may be underestimated. The 94% and 79% figures are reasonable approximations, not exact values.

</div>

<div class="de">

**Die Zahlen:**

- **Heimische Arten:** ~2.378 beobachtet von ~2.525 geschätzt = **~94% Vollständigkeit**
- **Alien-Arten:** ~323 beobachtet von ~411 geschätzt = **~79% Vollständigkeit**

Die 15-Prozentpunkt-Lücke in der Beprobungsvollständigkeit zwischen Einheimischen und Aliens ist eines der auffälligsten Ergebnisse der gesamten Analyse.

**Warum ist die Alien-Flora weniger vollständig?**

Drei komplementäre Mechanismen erklären diese Lücke:

1. **Fortlaufende Einführungen.** Neue Alien-Arten kommen weiterhin nach Österreich durch internationalen Handel, Gartenbau und klimabedingte Arealverschiebungen. Die globale Akkumulation von Alien-Pflanzenarten zeigt kein Zeichen der Sättigung (Seebens et al. 2017).

2. **Ausbreitungsverzögerung.** Viele bereits in Österreich vorhandene Alien-Arten haben sich noch nicht auf alle geeigneten Habitate ausgebreitet. Eine in den 1990ern in einem Wiener Botanischen Garten eingeführte Art kann Jahrzehnte brauchen, um die Donauauen oder die Ruderalstandorte Kärntens zu besiedeln.

3. **Nachweisschwierigkeit.** Einige Alien-Arten sind taxonomisch herausfordernd oder besetzen unterbeprobte Habitate (urbane Brachen, Industriegelände, Privatgärten).

**Das Konzept der Invasionsschuld:**

Essl et al. (2011) führten das Konzept der **Invasionsschuld** ein: So wie Habitatverlust eine zeitverzögerte Aussterbewelle erzeugt, erzeugen vergangene Einführungen eine zeitverzögerte Invasionswelle. Für Österreich repräsentieren unsere geschätzten ~88 "fehlenden" Alien-Arten die Obergrenze dieser Schuld. Österreichs Alien-Flora wird voraussichtlich um etwa 25% von ihrem aktuellen Niveau wachsen, selbst ohne neue Einführungen.

**Was das für die Naturschutzplanung bedeutet:**

Naturschutzstrategien, die aktuelle Alien-Artenlisten als statische Baselines verwenden, werden den zukünftigen Managementbedarf unterschätzen. Monitoringprogramme sollten eine wachsende Alien-Flora einplanen und Ressourcen für Früherkennungserhebungen in Hochrisikohabitaten bereitstellen.

**Modellvorbehalt:**

Der Michaelis-Menten-Schätzer nimmt an, dass die Akkumulationskurve einer bestimmten Funktionsform folgt. Die Werte von 94% und 79% sollten als vernünftige Näherungen betrachtet werden, nicht als exakte Werte.

</div>

</div>

---

## <span class="en">3b. Mapping the Invasion Debt: Estimated Richness per Hexagon</span><span class="de">3b. Kartierung der Invasionsschuld: Geschätzter Artenreichtum pro Hexagon</span>

<div class="en">

The Michaelis-Menten extrapolation above estimated **total** richness for all of Austria. Here we apply the same approach per hexagon: for each cell in the equal-area grid, we run a spatial accumulation with 10 seeds on the within-hex plots, fit Michaelis-Menten, and extract the estimated total species richness ($S_{max}$). This gives a map of *estimated* richness rather than raw observed counts. Hexagons with fewer than 20 plots (shown in light grey) are excluded because accumulation curves fitted to so few samples produce unreliable extrapolations.

</div>

<div class="de">

Die Michaelis-Menten-Extrapolation oben schätzte den **Gesamt**-Artenreichtum für ganz Österreich. Hier wenden wir denselben Ansatz pro Hexagon an: Für jede Zelle im flächengleichen Gitter führen wir eine räumliche Akkumulation mit 10 Seeds auf den Plots innerhalb des Hexagons durch, passen Michaelis-Menten an und extrahieren den geschätzten Gesamtartenreichtum ($S_{max}$). Hexagone mit weniger als 20 Plots (in Hellgrau dargestellt) sind ausgeschlossen, da Akkumulationskurven mit so wenigen Stichproben unzuverlässige Extrapolationen liefern.

</div>

```{r hex-sac-maps, fig.height=14, fig.width=10}
hex_estimates <- readRDS(file.path(comp_dir, "hex_sac_estimates.rds"))

hex_polys_sac <- cell_to_sf(hex_estimates$cell_id, grid = grid)
hex_polys_sac <- merge(hex_polys_sac, hex_estimates, by = "cell_id")

# Under-sampled hexagons (<20 plots) shown as light grey
hex_undersampled <- hex_polys[!hex_polys$cell_id %in% hex_estimates$cell_id, ]

# Estimated native richness
p1 <- ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_undersampled, fill = "#BDBDBD", color = "grey70", linewidth = 0.3) +
  geom_sf(data = hex_polys_sac, aes(fill = est_native), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_gradient(low = "white", high = "#2E7D32",
                      name = "Estimated\nnative S_max") +
  labs(title = "Estimated Native Richness (Michaelis-Menten) / Geschätzter heimischer Reichtum",
       subtitle = "Per-hexagon SAC extrapolation, 10 seeds each (grey = <20 plots, excluded)",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))

# Estimated alien richness
p2 <- ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_undersampled, fill = "#BDBDBD", color = "grey70", linewidth = 0.3) +
  geom_sf(data = hex_polys_sac, aes(fill = est_alien), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_gradient(low = "white", high = "#D32F2F",
                      name = "Estimated\nalien S_max") +
  labs(title = "Estimated Alien Richness (Michaelis-Menten) / Geschätzter Alien-Reichtum",
       subtitle = "Per-hexagon SAC extrapolation, 10 seeds each (grey = <20 plots, excluded)",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))

# Alien sampling completeness
hex_polys_sac$completeness_alien <- hex_estimates$obs_alien / hex_estimates$est_alien * 100

p3 <- ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_undersampled, fill = "#BDBDBD", color = "grey70", linewidth = 0.3) +
  geom_sf(data = hex_polys_sac, aes(fill = completeness_alien), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_distiller(palette = "YlOrRd", direction = 1,
                       name = "Alien\ncompleteness %") +
  labs(title = "Alien Sampling Completeness / Alien-Beprobungsvollständigkeit",
       subtitle = "Observed / estimated species per hexagon (grey = <20 plots, excluded)",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))

gridExtra::grid.arrange(p1, p2, p3, ncol = 1)
```

<div class="discussion-box">

<div class="en">

These maps translate the invasion debt into geography. While the first map (estimated native richness) echoes the observed raw-count maps from section 1, the alien map adds information: it shows where the Michaelis-Menten model predicts more species than we have actually found. The completeness map (bottom) highlights where the alien flora is least well-sampled. Regions with low completeness are where we should expect to find new alien records in coming years.

</div>

<div class="de">

Diese Karten übersetzen die Invasionsschuld in Geografie. Während die erste Karte (geschätzter heimischer Reichtum) die beobachteten Rohzählungskarten aus Abschnitt 1 widerspiegelt, fügt die Alien-Karte Information hinzu: Sie zeigt, wo das Michaelis-Menten-Modell mehr Arten vorhersagt, als wir tatsächlich gefunden haben. Die Vollständigkeitskarte (unten) hebt hervor, wo die Alien-Flora am wenigsten gut beprobt ist.

</div>

</div>

---

## <span class="en">3c. Sampling Gaps: How Many Species Are We Missing?</span><span class="de">3c. Beprobungslücken: Wie viele Arten fehlen uns?</span>

<div class="en">

Sections 3a--b showed estimated richness and completeness separately. Here we place the **observed** and **estimated** total species counts side by side on the same colour scale, making the sampling gap immediately visible. Where the estimated map is darker than the observed map, there are likely unrecorded species.

</div>

<div class="de">

Abschnitte 3a--b zeigten geschätzten Reichtum und Vollständigkeit getrennt. Hier stellen wir die **beobachteten** und **geschätzten** Gesamtartenzahlen nebeneinander auf derselben Farbskala dar, sodass die Beprobungslücke sofort sichtbar wird. Wo die geschätzte Karte dunkler ist als die beobachtete, gibt es wahrscheinlich unerfasste Arten.

</div>

```{r sampling-gaps, fig.height=10, fig.width=10}
# Total observed vs total estimated per hexagon
hex_polys_sac$obs_total <- hex_estimates$obs_native + hex_estimates$obs_alien
hex_polys_sac$est_total <- hex_estimates$est_native + hex_estimates$est_alien

# Shared colour range for direct comparison
total_range <- range(c(hex_polys_sac$obs_total, hex_polys_sac$est_total), na.rm = TRUE)

p_obs <- ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_undersampled, fill = "#BDBDBD", color = "grey70", linewidth = 0.3) +
  geom_sf(data = hex_polys_sac, aes(fill = obs_total), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_viridis_c(option = "viridis", direction = 1,
                       name = "Species\ncount",
                       limits = total_range) +
  labs(title = "Observed Total Richness / Beobachteter Gesamtreichtum",
       subtitle = "Native + alien species actually recorded per hexagon",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))

p_est <- ggplot() +
  geom_sf(data = austria_sf, fill = "grey95", color = "#333333", linewidth = 0.8) +
  geom_sf(data = hex_undersampled, fill = "#BDBDBD", color = "grey70", linewidth = 0.3) +
  geom_sf(data = hex_polys_sac, aes(fill = est_total), color = "white", linewidth = 0.3) +
  geom_sf(data = austria_sf, fill = NA, color = "#333333", linewidth = 1) +
  scale_fill_viridis_c(option = "viridis", direction = 1,
                       name = "Species\ncount",
                       limits = total_range) +
  labs(title = "Estimated Total Richness (Michaelis-Menten) / Geschätzter Gesamtreichtum",
       subtitle = "Extrapolated total species (S_max) per hexagon",
       x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 13) +
  coord_sf(xlim = c(9.3, 17.2), ylim = c(46.3, 49.1))

gridExtra::grid.arrange(p_obs, p_est, ncol = 1)
```

<div class="discussion-box">

<div class="en">

Comparing the two maps on the same scale reveals the sampling gap at a glance. Hexagons where the estimated map is noticeably darker harbour undetected species. The overall pattern shows that most hexagons have not yet reached their predicted asymptote, especially in the Alpine interior and along lowland transport corridors. This reinforces the message from section 3a: Austria's alien flora in particular remains incompletely sampled.

</div>

<div class="de">

Der Vergleich beider Karten auf derselben Skala macht die Beprobungslücke auf einen Blick sichtbar. Hexagone, in denen die geschätzte Karte deutlich dunkler ist, beherbergen unentdeckte Arten. Das Gesamtmuster zeigt, dass die meisten Hexagone ihre vorhergesagte Asymptote noch nicht erreicht haben, besonders im alpinen Innenraum und entlang der Tiefland-Verkehrskorridore. Dies bekräftigt die Botschaft aus Abschnitt 3a: Insbesondere Österreichs Alien-Flora ist noch unvollständig beprobt.

</div>

</div>

---

# <span class="en">4. Turnover, Not Nestedness: What Drives Austrian Beta Diversity</span><span class="de">4. Turnover, nicht Nestedness: Was Österreichs Beta-Diversität antreibt</span>

## <span class="en">Decomposing Beta Diversity</span><span class="de">Zerlegung der Beta-Diversität</span>

<div class="theory-box">

<div class="en">

Baselga (2010) showed that total beta diversity can be decomposed into two components:

$$\beta_{Sorensen} = \beta_{Turnover} + \beta_{Nestedness}$$

- **Turnover ($\beta_{sim}$):** Species are replaced by different species between sites
- **Nestedness ($\beta_{nes}$):** Species-poor sites are subsets of species-rich sites

The balance between these components reveals the *process* generating diversity differences: environmental filtering (turnover) versus differential species loss (nestedness).

</div>

<div class="de">

Baselga (2010) zeigte, dass die Gesamt-Beta-Diversität in zwei Komponenten zerlegt werden kann:

$$\beta_{Sorensen} = \beta_{Turnover} + \beta_{Nestedness}$$

- **Turnover ($\beta_{sim}$):** Arten werden zwischen Standorten durch andere Arten ersetzt
- **Nestedness ($\beta_{nes}$):** Artenarme Standorte sind Teilmengen artenreicher Standorte

Das Gleichgewicht zwischen diesen Komponenten verrät den *Prozess*, der Diversitätsunterschiede erzeugt: Umweltfilterung (Turnover) versus differenzieller Artenverlust (Nestedness).

</div>

</div>

<div class="info-box">

<div class="en">

**How to read the plot below:**

The x-axis shows the number of sites visited in a "spatial walk" across Austria -- starting at one random site and repeatedly adding the nearest unvisited site. The y-axis shows beta diversity (0--1 scale). There are three panels, one for each component:

- **Total ($\beta_{sor}$):** Overall compositional difference among all visited sites so far. Rises quickly and plateaus near 1, meaning Austrian sites become very different once the walk spans enough environmental gradients.
- **Turnover ($\beta_{sim}$):** The portion of that difference caused by species *replacement* (site A has species X, site B has species Y instead). If this panel is high, sites have genuinely different species.
- **Nestedness ($\beta_{nes}$):** The portion caused by species *loss* without replacement (species-poor sites are just subsets of richer sites). If this panel is low, communities are not simply nested versions of each other.

**Key comparison:** Since Total = Turnover + Nestedness, looking at which component is larger tells you *why* sites differ.

</div>

<div class="de">

**Wie man die Grafik liest:**

Die x-Achse zeigt die Anzahl der besuchten Standorte in einem "räumlichen Spaziergang" durch Österreich -- beginnend an einem zufälligen Standort und schrittweise den nächstgelegenen unbesuchten Standort hinzufügend. Die y-Achse zeigt die Beta-Diversität (Skala 0--1). Es gibt drei Panels, eines für jede Komponente:

- **Total ($\beta_{sor}$):** Gesamte kompositorische Unterschiede zwischen allen bisher besuchten Standorten. Steigt schnell an und nähert sich 1, d.h. österreichische Standorte werden sehr unterschiedlich, sobald der Spaziergang genug Umweltgradienten abdeckt.
- **Turnover ($\beta_{sim}$):** Der Anteil des Unterschieds, der durch Artenersatz entsteht (Standort A hat Art X, Standort B hat stattdessen Art Y). Wenn dieses Panel hoch ist, haben die Standorte tatsächlich verschiedene Arten.
- **Nestedness ($\beta_{nes}$):** Der Anteil, der durch Artenverlust ohne Ersatz entsteht (artenarme Standorte sind nur Teilmengen reicherer Standorte). Wenn dieses Panel niedrig ist, sind die Gemeinschaften keine verschachtelten Versionen voneinander.

**Wichtiger Vergleich:** Da Total = Turnover + Nestedness, zeigt der Vergleich der Komponenten, *warum* sich Standorte unterscheiden.

</div>

</div>

```{r beta-diversity, fig.height=8, fig.width=12}
beta_na <- readRDS(file.path(comp_dir, "beta_native_alien.rds"))

# Helper: extract beta components into a data frame
build_beta_df <- function(b, group_label) {
  n <- ncol(b$beta_total)
  data.frame(
    sites     = rep(seq_len(n), 3),
    value     = c(colMeans(b$beta_total),
                  colMeans(b$beta_turnover),
                  colMeans(b$beta_nestedness)),
    component = factor(
      rep(c("Total (bsor)", "Turnover (bsim)", "Nestedness (bnes)"), each = n),
      levels = c("Total (bsor)", "Turnover (bsim)", "Nestedness (bnes)")
    ),
    group = group_label
  )
}

df_beta <- rbind(
  build_beta_df(beta_na$native, "Native / Heimisch"),
  build_beta_df(beta_na$alien,  "Alien / Alien")
)

# 2-row x 3-column panel: Native on top, Alien on bottom, one column per component
ggplot(df_beta, aes(x = sites, y = value, colour = group)) +
  geom_line(linewidth = 0.9) +
  facet_grid(group ~ component, scales = "free_y") +
  scale_colour_manual(values = c("Native / Heimisch" = "#2E7D32", "Alien / Alien" = "#C62828")) +
  labs(
    title = "Beta Diversity Decomposition: Native vs Alien (1990s)",
    subtitle = "Baselga (2010) decomposition: \u03b2sor = \u03b2sim (turnover) + \u03b2nes (nestedness)",
    x = "Number of sites in spatial walk / Anzahl Standorte",
    y = "Beta diversity"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none",
        strip.text = element_text(face = "bold", size = 12))
```

## <span class="en">Discussion</span><span class="de">Diskussion</span>

<div class="discussion-box">

<div class="en">

**Turnover dominates for natives -- but what about aliens?**

The beta diversity decomposition reveals distinct patterns for **native** and **alien** species. Both groups are turnover-dominated, but with important differences.

**Natives:** Turnover is high and nestedness is low. This reflects Austria's 3,683 m elevation gradient (115 m Neusiedler See to 3,798 m Grossglockner), which creates distinct vegetation belts hosting genuinely **different species**, not nested subsets. A lowland *Quercus*-*Carpinus* forest and a high-alpine *Carex curvula* grassland share almost no species.

**Aliens:** Turnover also dominates, but the overall beta diversity is lower than for natives, and nestedness may be relatively more important. Alien species are drawn from a smaller pool concentrated in lowland and disturbed habitats. Some alien-poor sites (e.g., alpine areas) are effectively subsets of the richer alien floras in lowland cities -- a more nested pattern than natives show.

**Key contrast:** Natives show high turnover because different elevations have different species (environmental filtering). Aliens show turnover because different lowland regions receive different introduced species (introduction history), but also some nestedness because alien-poor sites simply lack the conditions for establishment rather than hosting alternative alien species.

**For conservation:**

In a turnover-dominated system, **no single reserve can capture the full flora**. This supports a distributed network of reserves across elevations and biogeographic regions (the "Several Small" side of the SLOSS debate; Tjorve 2010). For alien management, the comparison suggests that urban lowlands are not just richer in aliens but also harbour *different* aliens depending on the region.

</div>

<div class="de">

**Turnover dominiert bei Einheimischen -- aber was ist mit Neophyten?**

Die Beta-Diversitäts-Zerlegung zeigt unterschiedliche Muster für **heimische** und **gebietsfremde** Arten. Beide Gruppen sind Turnover-dominiert, aber mit wichtigen Unterschieden.

**Einheimische:** Turnover ist hoch und Nestedness niedrig. Dies spiegelt Österreichs 3.683-m-Höhengradienten (115 m Neusiedler See bis 3.798 m Großglockner) wider, der verschiedene Vegetationsgürtel mit **tatsächlich verschiedenen Arten** schafft. Ein Tiefland-*Quercus*-*Carpinus*-Wald und ein hochalpines *Carex curvula*-Grasland teilen praktisch keine Arten.

**Neophyten:** Auch hier dominiert Turnover, aber die Gesamt-Beta-Diversität ist niedriger als bei Einheimischen, und Nestedness könnte relativ wichtiger sein. Neophyten stammen aus einem kleineren Pool, der sich auf Tiefland- und Störungshabitate konzentriert. Einige neophytenarme Standorte (z.B. alpine Gebiete) sind effektiv Teilmengen der reicheren Neophyten-Flora in Tieflandstädten -- ein stärker verschachteltes Muster als bei Einheimischen.

**Zentraler Kontrast:** Einheimische zeigen hohen Turnover, weil verschiedene Höhenlagen verschiedene Arten beherbergen (Umweltfilterung). Neophyten zeigen Turnover, weil verschiedene Tieflandregionen verschiedene eingeführte Arten erhalten (Einführungsgeschichte), aber auch etwas Nestedness, weil neophytenarme Standorte einfach die Bedingungen für Etablierung fehlen.

**Naturschutzimplikationen:**

In einem turnover-dominierten System **kann kein einzelnes Schutzgebiet die gesamte Flora erfassen**. Dies unterstützt ein verteiltes Netzwerk von Reservaten über verschiedene Höhenlagen und biogeografische Regionen (die "Several Small"-Position in der SLOSS-Debatte; Tjorve 2010). Für das Neophyten-Management zeigt der Vergleich, dass städtische Tieflandgebiete nicht nur mehr Neophyten beherbergen, sondern auch *verschiedene* Neophyten je nach Region.

</div>

</div>

---

# <span class="en">5. Habitat Vulnerability: Where Invasions Concentrate</span><span class="de">5. Habitat-Verwundbarkeit: Wo sich Invasionen konzentrieren</span>

## <span class="en">Alien Species Share by Habitat</span><span class="de">Alien-Artenanteil nach Habitat</span>

```{r habitat-alien-share, fig.width=9, fig.height=5}
hab_alien <- header[, .(PlotObservationID, Eunis_lvl1)]
hab_alien <- merge(hab_alien,
                   species[, .(n_native = sum(STATUS == "native"),
                               n_alien  = sum(STATUS == "neo")),
                           by = PlotObservationID],
                   by = "PlotObservationID")
keep_habs <- names(which(table(header$Eunis_lvl1) >= 100))
hab_summary <- hab_alien[Eunis_lvl1 %in% keep_habs,
                         .(mean_native = round(mean(n_native), 1),
                           mean_alien  = round(mean(n_alien), 1),
                           alien_pct   = round(mean(n_alien / (n_native + n_alien)) * 100, 1)),
                         by = Eunis_lvl1]

# Add human-readable EUNIS level 1 labels
eunis_labels <- c(
  C = "Inland surface waters",
  D = "Mires, bogs & fens",
  E = "Grasslands",
  F = "Shrub heathlands",
  G = "Woodland & forest",
  H = "Inland unvegetated",
  I = "Arable land & gardens",
  J = "Urban & industrial",
  K = "Not applicable",
  MA = "Coastal saltmarshes",
  N = "Coastal habitats",
  Q = "Wetlands",
  R = "Grasslands & tall forbs",
  S = "Arctic/alpine scrub",
  T = "Forests",
  U = "Inland cliffs & screes",
  V = "Man-made habitats"
)
hab_summary[, habitat_name := ifelse(
  Eunis_lvl1 %in% names(eunis_labels),
  paste0(Eunis_lvl1, " \u2013 ", eunis_labels[Eunis_lvl1]),
  Eunis_lvl1
)]

setorder(hab_summary, alien_pct)
hab_summary[, habitat_name := factor(habitat_name, levels = habitat_name)]

# Bar chart
ggplot(hab_summary, aes(x = habitat_name, y = alien_pct)) +
  geom_col(fill = "#D32F2F", width = 0.7) +
  geom_text(aes(label = paste0(alien_pct, "%")),
            hjust = -0.15, size = 3.5) +
  coord_flip(clip = "off") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(x = NULL,
       y = "Alien species share (%) / Alien-Artenanteil (%)",
       title = "Alien share by EUNIS habitat / Alien-Anteil nach EUNIS-Habitat") +
  theme_minimal(base_size = 13) +
  theme(plot.title = element_text(face = "bold", size = 14),
        panel.grid.major.y = element_blank())
```

## <span class="en">Accumulation Curves by Habitat</span><span class="de">Akkumulationskurven nach Habitat</span>

```{r habitat-curves}
hab_results <- readRDS(file.path(comp_dir, "habitat_curves.rds"))
hab_combined <- do.call(c, hab_results)
plot(hab_combined) +
  ggtitle("Species Accumulation by EUNIS Habitat (level 1)") +
  theme_minimal(base_size = 13)
```

```{r habitat-native-alien, fig.height=12}
hab_na_results <- readRDS(file.path(comp_dir, "habitat_native_alien.rds"))

plots_hab <- lapply(keep_habs, function(h) {
  if (is.null(hab_na_results[[h]])) return(NULL)
  lab <- if (h %in% names(eunis_labels)) paste0(h, " \u2013 ", eunis_labels[h]) else h
  plot_normalized(Native = hab_na_results[[h]]$native,
                  Alien  = hab_na_results[[h]]$alien,
                  title = sprintf("%s: Native vs Alien (normalized)", lab)) +
    scale_color_manual(values = c("Native" = "#2E7D32", "Alien" = "#D32F2F")) +
    scale_fill_manual(values = c("Native" = "#2E7D32", "Alien" = "#D32F2F"))
})
plots_hab <- plots_hab[!vapply(plots_hab, is.null, logical(1))]
gridExtra::grid.arrange(grobs = plots_hab, ncol = 2)
```

## <span class="en">Estimated Richness by Habitat (SAC-based)</span><span class="de">Geschätzter Artenreichtum nach Habitat (SAC-basiert)</span>

```{r habitat-sac-chart, fig.width=10, fig.height=6}
hab_estimates <- readRDS(file.path(comp_dir, "habitat_sac_estimates.rds"))

hab_estimates[, habitat_name := ifelse(
  habitat %in% names(eunis_labels),
  paste0(habitat, " \u2013 ", eunis_labels[habitat]),
  habitat
)]

hab_long <- melt(hab_estimates,
                 id.vars = c("habitat", "habitat_name", "n_plots"),
                 measure.vars = c("obs_native", "est_native", "obs_alien", "est_alien"),
                 variable.name = "metric", value.name = "species")

hab_long[, group := ifelse(grepl("native", metric), "Native", "Alien")]
hab_long[, type := ifelse(grepl("obs_", metric), "Observed", "Estimated (MM)")]

setorder(hab_long, -species)
hab_long[, habitat_name := factor(habitat_name,
                                   levels = unique(hab_estimates[order(est_native)]$habitat_name))]

ggplot(hab_long, aes(x = habitat_name, y = species, fill = interaction(group, type))) +
  geom_col(position = position_dodge(width = 0.7), width = 0.6) +
  coord_flip(clip = "off") +
  scale_fill_manual(
    values = c("Native.Observed" = "#66BB6A", "Native.Estimated (MM)" = "#2E7D32",
               "Alien.Observed"  = "#EF9A9A", "Alien.Estimated (MM)"  = "#C62828"),
    labels = c("Native.Observed" = "Native (observed)", "Native.Estimated (MM)" = "Native (estimated)",
               "Alien.Observed"  = "Alien (observed)",  "Alien.Estimated (MM)"  = "Alien (estimated)"),
    name = NULL
  ) +
  labs(x = NULL,
       y = "Species count / Artenzahl",
       title = "Observed vs Estimated Richness by Habitat / Beobachteter vs geschätzter Reichtum") +
  theme_minimal(base_size = 13) +
  theme(plot.title = element_text(face = "bold", size = 14),
        panel.grid.major.y = element_blank(),
        legend.position = "bottom")
```

## <span class="en">Discussion</span><span class="de">Diskussion</span>

<div class="discussion-box">

<div class="en">

**Invasion varies hugely between habitats.**

The bar chart makes this clear: some habitats have alien proportions above 10%, others are almost alien-free. This is not random.

**Most invaded habitats** share three traits:

- **Frequent disturbance** (ploughing, mowing, flooding) creates open niches. Repeated disturbance prevents native competitive exclusion.
- **High nutrient availability.** Fertilised grasslands, floodplains, roadside verges get regular resource pulses that favour alien establishment (Davis et al. 2000).
- **Human connectivity.** Railway embankments, highway margins, and canal banks receive a steady supply of alien propagules.

**Least invaded habitats** include:

- **Alpine grasslands** (short growing seasons, frost, thin soils exclude most aliens)
- **Oligotrophic bogs and fens** (nutrient-poor, waterlogged; most aliens can't cope)
- **Closed-canopy forests** (light limitation at ground level blocks alien germination, though gaps and edges show higher alien presence)

Chytry et al. (2008) showed that European habitats differ 100-fold in invasion susceptibility. Our data confirms this for Austria: **habitat type matters more than climate, geography, or propagule pressure**.

**Within-habitat accumulation curves:**

In heavily invaded habitats, the alien curve approaches the native curve (aliens have spread broadly). In lightly invaded habitats, the alien curve is steeper and erratic (a few occurrences at a few sites, typical of early-stage invasion).

**Management priorities:**

1. **High:** Most invaded habitats, where aliens are already abundant. Early action prevents further establishment.
2. **Medium:** Transition habitats where aliens are present but not yet dominant.
3. **Lower:** Alpine and oligotrophic habitats resist invasion for now, but climate change may weaken that resistance.

</div>

<div class="de">

**Invasion ist nicht gleichmäßig über Habitate verteilt.**

Die EUNIS-Habitat-Analyse zeigt, dass die Invasion durch Alien-Arten sehr heterogen ist. Einige Habitate zeigen Alien-Anteile über 10%, während andere praktisch alien-frei bleiben. Diese Heterogenität folgt klaren ökologischen Regeln.

**Welche Habitate sind am stärksten invadiert und warum?**

Die am stärksten invadierten Habitate in Österreich teilen mehrere Merkmale:

- **Hohe Störungsfrequenz.** Regelmäßig physisch gestörte Habitate (Pflügen, Mähen, Trampeln, Überflutung) schaffen offene Nischen für Alien-Besiedelung.

- **Hohe Ressourcenverfügbarkeit.** Nährstoffreiche Habitate (gedüngte Grasländer, Flussauen mit Sedimentablagerung) liefern die Ressourcen für schnelle Alien-Etablierung. Die Hypothese der schwankenden Ressourcen (Davis et al. 2000) sagt voraus, dass Invasion während Ressourcenpulsen ihren Höhepunkt erreicht.

- **Starke menschliche Konnektivität.** Habitate entlang von Transportkorridoren erhalten eine kontinuierliche Versorgung mit Alien-Propagules.

**Welche Habitate widerstehen der Invasion?**

- **Alpine und subalpine Grasländer.** Raue Klimabedingungen schließen die meisten Alien-Arten aus.
- **Oligotrophe Moore und Feuchtgebiete.** Nährstoffarme, wassergesättigte Bedingungen schaffen starke Umweltfilter.
- **Geschlossene Wälder.** Lichtlimitierung verhindert Alien-Etablierung unter dichtem Kronendach.

**Die 100-fache Variation:**

Chytry et al. (2008) zeigten, dass europäische Habitate sich 100-fach in ihrer Anfälligkeit für Pflanzeninvasionen unterscheiden. Unsere österreichischen Daten bestätigen dies: **Habitattyp ist der primäre Determinant der Invasionsanfälligkeit**, wichtiger als Klima, Geografie oder Propagule Pressure.

**Akkumulationskurvenformen unterscheiden sich:**

- In stark invadierten Habitaten nähert sich die Alien-Kurvenform der heimischen an — Aliens haben sich breit verteilt.
- In schwach invadierten Habitaten ist die Alien-Kurve steiler und unregelmäßiger — das Zeichen einer Frühphasen-Invasion.

**Praktische Anwendung für den Naturschutz:**

1. **Hohe Priorität:** Am stärksten invadierte Habitattypen überwachen und managen.
2. **Mittlere Priorität:** Habitate an der Übergangszone beobachten — die "Invasionsfronten", wo Management am kosteneffektivsten sein kann.
3. **Niedrigere Priorität:** Alpine und oligotrophe Habitate, die derzeit Invasion widerstehen, langfristig monitoren, besonders angesichts des Klimawandels.

</div>

</div>

---

# <span class="en">6. Beyond Species Counts: Diversity Partitioning and Phylogeny</span><span class="de">6. Jenseits der Artenzahlen: Diversitätspartitionierung und Phylogenie</span>

<div class="en">

Species accumulation curves count species, but biodiversity has multiple dimensions. Here we present three additional analyses from the `spacc` pipeline: **Hill numbers** (effective diversity at different weighting), **alpha/beta/gamma partitioning**, and **phylogenetic diversity accumulation**.

</div>

<div class="de">

Artenakkumulationskurven zählen Arten, aber Biodiversität hat mehrere Dimensionen. Hier präsentieren wir drei zusätzliche Analysen aus der `spacc`-Pipeline: **Hill-Zahlen** (effektive Diversität bei verschiedener Gewichtung), **Alpha/Beta/Gamma-Partitionierung** und **phylogenetische Diversitätsakkumulation**.

</div>

## <span class="en">Hill Numbers: How Dominance Shapes Diversity</span><span class="de">Hill-Zahlen: Wie Dominanz Diversität formt</span>

<div class="theory-box">

<div class="en">

**Hill numbers** (or effective number of species) weight species differently by their abundance:

- $q = 0$: All species count equally (= species richness)
- $q = 1$: Species weighted by their frequency (= exponential of Shannon entropy)
- $q = 2$: Dominant species count most (= inverse Simpson)

As $q$ increases, rare species contribute less. If the curves diverge strongly, rare species drive the pattern.

</div>

<div class="de">

**Hill-Zahlen** gewichten Arten unterschiedlich nach ihrer Häufigkeit:

- $q = 0$: Alle Arten gleich gewichtet (= Artenreichtum)
- $q = 1$: Arten nach Frequenz gewichtet (= Exponential der Shannon-Entropie)
- $q = 2$: Dominante Arten zählen am meisten (= inverser Simpson)

</div>

</div>

```{r hill-native-alien, fig.height=8, fig.width=10}
hill_na <- readRDS(file.path(comp_dir, "hill_native_alien.rds"))

# Build a combined data frame for native and alien Hill curves
build_hill_df <- function(h, group_label) {
  q_names <- names(h$curves)
  n <- ncol(h$curves[[1]])
  do.call(rbind, lapply(q_names, function(qn) {
    data.frame(
      sites = seq_len(n),
      value = colMeans(h$curves[[qn]]),
      q     = qn,
      group = group_label
    )
  }))
}

df_hill <- rbind(
  build_hill_df(hill_na$native, "Native / Heimisch"),
  build_hill_df(hill_na$alien,  "Alien / Alien")
)
df_hill$q <- factor(df_hill$q,
                    levels = c("q0.0", "q1.0", "q2.0"),
                    labels = c("q = 0 (Richness)", "q = 1 (Shannon)", "q = 2 (Simpson)"))

ggplot(df_hill, aes(x = sites, y = value, colour = group)) +
  geom_line(linewidth = 0.8, alpha = 0.9) +
  facet_wrap(~ q, scales = "free_y", ncol = 1) +
  scale_colour_manual(values = c("Native / Heimisch" = "#2E7D32", "Alien / Alien" = "#C62828")) +
  labs(
    title = "Hill Numbers: Native vs Alien Species Accumulation",
    subtitle = "q=0: species richness, q=1: Shannon, q=2: Simpson / Artenreichtum, Shannon, Simpson",
    x = "Number of sites in spatial walk / Anzahl Standorte",
    y = "Effective number of species",
    colour = NULL
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "top",
        strip.text = element_text(face = "bold", size = 12))
```

## <span class="en">Alpha, Beta, Gamma Partition</span><span class="de">Alpha-, Beta-, Gamma-Partitionierung</span>

```{r diversity-partition, fig.height=5}
partition <- readRDS(file.path(comp_dir, "partition.rds"))
plot(partition) +
  ggtitle("Diversity Partitioning: Alpha, Beta, Gamma") +
  theme_minimal(base_size = 13)
```

## <span class="en">Phylogenetic Diversity Accumulation</span><span class="de">Phylogenetische Diversitätsakkumulation</span>

<div class="en">

Phylogenetic diversity captures the evolutionary breadth of a community. We tracked **Mean Pairwise Distance (MPD)** as the spatial accumulation expands: as more distantly related species are added, MPD increases. We also compared native vs alien phylogenetic diversity separately.

</div>

<div class="de">

Phylogenetische Diversität erfasst die evolutionäre Breite einer Gemeinschaft. Wir haben die **mittlere paarweise Distanz (MPD)** verfolgt, während sich die räumliche Akkumulation ausdehnt. Wir haben auch die phylogenetische Diversität für Einheimische und Aliens getrennt verglichen.

</div>

```{r phylo-accumulation, fig.height=6, fig.width=10}
phylo_sac <- readRDS(file.path(comp_dir, "phylo_sac.rds"))

# Extract mean curves across seeds
mpd_mean  <- colMeans(phylo_sac$curves$mpd)
mntd_mean <- colMeans(phylo_sac$curves$mntd)

df_phylo_all <- data.frame(
  sites  = rep(seq_along(mpd_mean), 2),
  value  = c(mpd_mean, mntd_mean),
  metric = factor(
    rep(c("MPD (Mean Pairwise Distance)",
          "MNTD (Mean Nearest Taxon Distance)"), each = length(mpd_mean)),
    levels = c("MPD (Mean Pairwise Distance)",
               "MNTD (Mean Nearest Taxon Distance)"))
)

ggplot(df_phylo_all, aes(x = sites, y = value, colour = metric)) +
  geom_line(linewidth = 0.9) +
  facet_wrap(~ metric, scales = "free_y", ncol = 1) +
  scale_colour_manual(values = c(
    "MPD (Mean Pairwise Distance)" = "#1565C0",
    "MNTD (Mean Nearest Taxon Distance)" = "#E65100")) +
  labs(
    title = "Phylogenetic Diversity Accumulation (1990s)",
    subtitle = "MPD and MNTD accumulation across spatial walk / MPD- und MNTD-Akkumulation",
    x = "Number of sites in spatial walk / Anzahl Standorte",
    y = "Phylogenetic distance"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none",
        strip.text = element_text(face = "bold", size = 12))
```

```{r phylo-native-alien, fig.height=5, fig.width=10}
pna <- readRDS(file.path(comp_dir, "phylo_native_alien.rds"))

# Extract mean MPD curves across seeds
native_mpd <- colMeans(pna$native$curves$mpd)
alien_mpd  <- colMeans(pna$alien$curves$mpd)

df_phylo <- data.frame(
  sites = rep(seq_along(native_mpd), 2),
  mpd   = c(native_mpd, alien_mpd),
  group = rep(c("Native / Heimisch", "Alien / Alien"), each = length(native_mpd))
)

ggplot(df_phylo, aes(x = sites, y = mpd, colour = group)) +
  geom_line(linewidth = 0.8, alpha = 0.8) +
  facet_wrap(~ group, scales = "free_y") +
  scale_colour_manual(values = c("Native / Heimisch" = "#2E7D32", "Alien / Alien" = "#C62828")) +
  labs(
    title = "Phylogenetic Diversity: Native vs Alien MPD Accumulation",
    subtitle = "Spatial accumulation of MPD for native vs alien species / MPD-Akkumulation: heimisch vs. gebietsfremd",
    x = "Number of sites in spatial walk / Anzahl Standorte im räumlichen Walk",
    y = "Mean Pairwise Distance (MPD)"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none",
        strip.text = element_text(face = "bold", size = 13))
```

## <span class="en">Discussion</span><span class="de">Diskussion</span>

<div class="discussion-box">

<div class="en">

**Hill numbers** show that the gap between $q=0$ (all species) and $q=2$ (dominant species) widens as sampling extends. This means many of the species added in later stages of the spatial walk are rare, occurring at only a few sites. The early accumulation is driven by common species shared broadly; the late accumulation adds rare specialists that inflate richness ($q=0$) without affecting dominance-weighted diversity ($q=2$) much.

**Diversity partitioning** confirms that beta diversity (among-site turnover) accounts for a large share of total (gamma) diversity. This is consistent with the turnover dominance found in section 4 using Baselga's decomposition.

**Phylogenetic results** show that MPD rises as the sampling window expands geographically: distant sites add not just different species but species from different lineages. This is expected in a country spanning lowland steppe to alpine tundra. The native flora covers broader phylogenetic space than the alien flora, which is concentrated in a few families (Asteraceae, Poaceae, Brassicaceae). Alien species tend to be phylogenetically clustered, consistent with trait-based filters favouring particular lineages for successful invasion (Cadotte et al. 2009).

</div>

<div class="de">

**Hill-Zahlen** zeigen, dass die Lücke zwischen $q=0$ (alle Arten) und $q=2$ (dominante Arten) sich erweitert, wenn die Beprobung zunimmt. Viele der spät hinzugefügten Arten sind selten. Die frühe Akkumulation wird von häufigen, breit geteilten Arten angetrieben; die späte Akkumulation fügt seltene Spezialisten hinzu.

**Diversitätspartitionierung** bestätigt, dass Beta-Diversität (Turnover zwischen Standorten) einen großen Anteil an der gesamten Gamma-Diversität ausmacht.

**Phylogenetische Ergebnisse** zeigen, dass MPD mit zunehmender geografischer Ausdehnung ansteigt: Entfernte Standorte fügen nicht nur andere Arten hinzu, sondern Arten aus anderen Abstammungslinien. Die heimische Flora umfasst einen breiteren phylogenetischen Raum als die Alien-Flora, die sich auf wenige Familien konzentriert (Asteraceae, Poaceae, Brassicaceae).

</div>

</div>

---

# <span class="en">Synthesis</span><span class="de">Synthese</span>

<div class="results-box">

<div class="en">

The six findings connect:

**1. Sampling & raw richness.** The hotspot maps reflect where data was collected and what observed richness looks like. Natives peak in topographically complex pre-Alpine zones; aliens concentrate around human infrastructure in the lowlands. These patterns partly reflect sampling effort.

**2. Accumulation curves.** Aliens have higher spatial beta diversity than natives; you need to sample more area to find the same proportion of species. This confirms quantitatively what the maps show.

**3. Incomplete sampling.** We know ~94% of the native flora but only ~79% of the alien flora. The gap represents invasion debt: species already present but not yet found, or species still arriving. The per-hexagon extrapolation maps show where in Austria that debt is concentrated.

**4. Turnover, not nestedness.** Austria's high beta diversity comes from genuine species replacement along the elevation gradient, not from impoverished subsets. No single reserve can capture the full flora.

**5. Habitat filters.** Invasion concentrates in disturbed, nutrient-rich, well-connected habitats and is excluded from alpine, oligotrophic, and closed-canopy environments.

**6. Multiple dimensions of diversity.** Hill numbers, diversity partitioning, and phylogenetic accumulation all tell the same story from different angles: rare species drive the tail of the accumulation curve, beta diversity dominates gamma, and alien species are phylogenetically more clustered than natives.

These results show that **spatial species accumulation curves** are more than a sampling tool. They connect biogeography, invasion ecology, and conservation planning. The `spacc` package makes this type of analysis available for any georeferenced community dataset.

</div>

<div class="de">

Diese sechs Ergebnisse bilden ein Gesamtbild über Österreichs Pflanzendiversität und ihre Invasion durch Alien-Arten:

**1. Beprobung & beobachteter Reichtum.** Die Hotspot-Karten zeigen, wo beprobt wurde und wie der beobachtete Artenreichtum aussieht. Einheimische erreichen ihren Höhepunkt in den topografisch komplexen Voralpen; Aliens konzentrieren sich um menschliche Infrastruktur im Tiefland. Diese Muster spiegeln teilweise den Beprobungsaufwand wider.

**2. Räumliche Akkumulation.** Die normalisierten Kurven zeigen, dass Aliens eine höhere räumliche Beta-Diversität haben als Einheimische.

**3. Unvollständige Beprobung.** Die Extrapolation zeigt, dass wir nur ~79% der Alien-Flora kennen gegenüber ~94% der Einheimischen. Die Hexagon-Karten lokalisieren, wo diese Schuld konzentriert ist.

**4. Turnover, nicht Nestedness.** Österreichs hohe Beta-Diversität entsteht durch echten Artenersatz entlang des Höhengradienten. Kein einzelnes Reservat kann die gesamte Flora erfassen.

**5. Habitatfilter.** Alien-Invasion konzentriert sich in gestörten, nährstoffreichen Habitaten und wird aus rauen, oligotrophen Umgebungen ausgeschlossen.

**6. Mehrere Diversitätsdimensionen.** Hill-Zahlen, Diversitätspartitionierung und phylogenetische Akkumulation erzählen dieselbe Geschichte aus verschiedenen Blickwinkeln: Seltene Arten treiben das Ende der Akkumulationskurve, Beta-Diversität dominiert Gamma, und Alien-Arten sind phylogenetisch stärker geclustert als Einheimische.

Zusammen zeigen diese Ergebnisse, dass **räumliche Artenakkumulationskurven** weit mehr als eine Beprobungsmethode sind.

</div>

</div>

---

## <span class="en">References</span><span class="de">Literaturverzeichnis</span>

<div class="lit-box">

- Baselga, A. (2010). Partitioning the turnover and nestedness components of beta diversity. *Global Ecology and Biogeography*, 19, 134--143.
- Cadotte, M.W. et al. (2009). Using phylogenetic, functional and trait diversity to understand patterns of plant community productivity. *PLoS ONE*, 4, e5695.
- Chao, A. & Jost, L. (2012). Coverage-based rarefaction and extrapolation. *Methods in Ecology and Evolution*, 3, 217--226.
- Chytry, M. et al. (2008). Habitat invasions by alien plants: a quantitative comparison among Mediterranean, subcontinental and oceanic regions of Europe. *Journal of Applied Ecology*, 45, 448--458.
- Chytry, M. et al. (2009). European map of alien plant invasions based on the quantitative assessment across habitats. *Diversity and Distributions*, 15, 98--107.
- Chytry, M. et al. (2016). European Vegetation Archive (EVA): an integrated database of European vegetation plots. *Applied Vegetation Science*, 19, 173--180.
- Colwell, R.K. & Coddington, J.A. (1994). Estimating terrestrial biodiversity through extrapolation. *Philosophical Transactions of the Royal Society B*, 345, 101--118.
- Davis, M.A. et al. (2000). Fluctuating resources in plant communities: a general theory of invasibility. *Journal of Ecology*, 88, 528--534.
- Essl, F. et al. (2011). Socioeconomic legacy yields an invasion debt. *Proceedings of the National Academy of Sciences*, 108, 203--207.
- Grabherr, G. et al. (2003). *Die Pflanzengesellschaften Osterreichs*. Gustav Fischer Verlag.
- Hill, M.O. (1973). Diversity and evenness: a unifying notation and its consequences. *Ecology*, 54, 427--432.
- Jost, L. (2006). Entropy and diversity. *Oikos*, 113, 363--375.
- Kier, G. et al. (2009). A global assessment of endemism and species richness across island and mainland regions. *PNAS*, 106, 9322--9327.
- Lockwood, J.L. et al. (2005). The role of propagule pressure in explaining species invasions. *Trends in Ecology & Evolution*, 20, 223--228.
- Partel, M. et al. (2011). Dark diversity: shedding light on absent species. *Trends in Ecology & Evolution*, 26, 596--600.
- Pysek, P. et al. (2010). Disentangling the role of environmental and human pressures on biological invasions across Europe. *PNAS*, 107, 12157--12162.
- Rahbek, C. (1995). The elevational gradient of species richness: a uniform pattern? *Ecography*, 18, 200--205.
- Seebens, H. et al. (2017). No saturation in the accumulation of alien species worldwide. *Nature Communications*, 8, 14435.
- Socolar, J.B. et al. (2016). How should beta-diversity inform biodiversity conservation? *Trends in Ecology & Evolution*, 31, 67--80.
- Tjorve, E. (2010). How to resolve the SLOSS debate: lessons from species-diversity models. *Journal of Theoretical Biology*, 264, 604--612.
- Wilson, J.R.U. et al. (2007). Residence time and potential range: crucial considerations in modelling plant invasions. *Diversity and Distributions*, 13, 11--22.

</div>

---

## <span class="en">Session Info</span><span class="de">Session Info</span>

```{r session-info}
sessionInfo()
```
